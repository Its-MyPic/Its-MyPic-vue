import{k as R,r as y,D as I,I as K,X as o,F as r,a5 as k,a7 as b,J as pe,$ as U,c as N,a2 as $e,u as w,B as Fe,E as C,L as Se,w as J,l as oe,a8 as de,O as Re,a9 as Ee,aa as je,ab as Le,Y as Ge,ac as Ae}from"./@vue-CNCR8Vmv.js";import{e as Y,f as Ne,g as ce,h as fe,i as le,j as O,k as X,l as me,n as Pe,o as Z,p as Q,u as qe,q as ze,r as Be,s as Qe,t as ne,v as B,w as H,x as be,y as Ce,z as Ye,A as We,B as xe,C as He,D as Je}from"./vuetify-eRZ44bXF.js";import{m as z,a as ke,b as Ze,c as Ke,d as Xe}from"./@mdi-DKC2W5MC.js";import{d as re,s as et}from"./pinia-CqnXpMGa.js";import{m as q}from"./protobufjs-BB8YXKI6.js";import{C as tt,t as nt,c as at}from"./opencc-js-D-mJJ3do.js";import"./typescript-B0P19iQY.js";import{G as ot}from"./gif.js-BUXYDTUc.js";import{G as lt}from"./vue-virtual-scroll-grid-DXBkyr0D.js";import"./@protobufjs-Cx6lg0nV.js";const rt="MTMzNTEwMzQ1NzY4MTczNTc2MC9LT0lwZ2FDc3RmRURnVHVqR2dEYmVYWWZSLUdZRjVQQ29veXZ0TFVGbFhFM0tYdGRGTzhHR3RrTXptWEp4R3FxQVI5bw==",it={MyGO:{1:"https://www.youtube.com/watch?v=WOrYBIYIwyk",2:"https://www.youtube.com/watch?v=WOrYBIYIwyk",3:"https://www.youtube.com/watch?v=WOrYBIYIwyk",4:"https://www.youtube.com/watch?v=ijdspfPMzYc",5:"https://www.youtube.com/watch?v=zfA0zRAkAdk",6:"https://www.youtube.com/watch?v=UwgyEoB9vU8",7:"https://www.youtube.com/watch?v=rlY2b3TIYPs",8:"https://www.youtube.com/watch?v=mfboDpl88QY",9:"https://www.youtube.com/watch?v=ySjYENzyZmY",10:"https://www.youtube.com/watch?v=bLWDIYpGcEI",11:"https://www.youtube.com/watch?v=gAFDVnhX24o",12:"https://www.youtube.com/watch?v=wei3payuSi8",13:"https://www.youtube.com/watch?v=uQ3_PvPCNnI"},"Ave Mujica":{1:"https://www.youtube.com/watch?v=dxmmSFQxWzM",2:"https://www.youtube.com/watch?v=Bzl61esi4qc",3:"https://www.youtube.com/watch?v=HagaJboujK4",4:"https://www.youtube.com/watch?v=Z6cOxtDsfNU",5:"https://www.youtube.com/watch?v=7D2uGv7aprQ",6:"https://www.youtube.com/watch?v=jQraN1emvLQ",7:"https://www.youtube.com/watch?v=RONGNWb7OpQ",8:"https://www.youtube.com/watch?v=uh9jUhVTS28",9:"https://www.youtube.com/watch?v=pGrI6hk0vBg",10:"https://www.youtube.com/watch?v=m9cjOcCKIyQ",11:"https://www.youtube.com/watch?v=Cfm8TWGkvYQ",12:"https://www.youtube.com/watch?v=UtSEFdDZZLw"}},ae={webhook:rt,videoLink:it},De=R({__name:"ReportDialog",props:{fileName:{type:String,required:!1,default:""},text:{type:String,required:!1,default:""}},setup(p){const l=p,a=y(""),e=y(""),t=y(!1),n=y(!1);async function d(){let u="";if(a.value&&(u+=`問題: ${a.value}
`),e.value&&(u+=`聯絡方式: ${e.value}
`),l.fileName&&(u+=`檔案名稱: ${l.fileName}
`),l.text&&(u+=`文字: ${l.text}
`),u){const f={content:u};await fetch(`https://discord.com/api/webhooks/${atob(ae.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),t.value=!0}n.value=!1}return(u,f)=>(I(),K(pe,null,[o(X,{modelValue:n.value,"onUpdate:modelValue":f[2]||(f[2]=s=>n.value=s),activator:"parent","max-width":"600px",style:{maxHeight:"90vh"},transition:"dialog-bottom-transition"},{default:r(()=>[o(Y,null,{default:r(()=>[o(Ne,null,{default:r(()=>f[4]||(f[4]=[k("回報問題")])),_:1}),o(ce,null,{default:r(()=>[o(fe,{label:"你遭遇到的問題(選填)",modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=s=>a.value=s),outlined:""},null,8,["modelValue"]),o(fe,{label:"你的聯絡方式(選填)",modelValue:e.value,"onUpdate:modelValue":f[1]||(f[1]=s=>e.value=s),outlined:""},null,8,["modelValue"])]),_:1}),o(le,null,{default:r(()=>[o(O,{onClick:d},{default:r(()=>f[5]||(f[5]=[k("送出")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(me,{modelValue:t.value,"onUpdate:modelValue":f[3]||(f[3]=s=>t.value=s),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>f[6]||(f[6]=[b("div",{class:"text-h6 mx-auto font-weight-bold text-center text-truncate"}," 已回報問題 ",-1)])),_:1},8,["modelValue"])],64))}}),j=q.Reader,Ie=q.Writer,L=q.util,D=q.roots.default||(q.roots.default={}),st=D.data=(()=>{const p={};return p.Info=function(){function l(a){if(a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.text="",l.prototype.season=0,l.prototype.episode=0,l.prototype.frameStart=0,l.prototype.framePrefer=0,l.prototype.frameEnd=0,l.prototype.segmentId=0,l.create=function(e){return new l(e)},l.encode=function(e,t){return t||(t=Ie.create()),e.text!=null&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),e.season!=null&&Object.hasOwnProperty.call(e,"season")&&t.uint32(16).int32(e.season),e.episode!=null&&Object.hasOwnProperty.call(e,"episode")&&t.uint32(24).int32(e.episode),e.frameStart!=null&&Object.hasOwnProperty.call(e,"frameStart")&&t.uint32(32).int32(e.frameStart),e.framePrefer!=null&&Object.hasOwnProperty.call(e,"framePrefer")&&t.uint32(40).int32(e.framePrefer),e.frameEnd!=null&&Object.hasOwnProperty.call(e,"frameEnd")&&t.uint32(48).int32(e.frameEnd),e.segmentId!=null&&Object.hasOwnProperty.call(e,"segmentId")&&t.uint32(56).int32(e.segmentId),t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof j||(e=j.create(e));let n=t===void 0?e.len:e.pos+t,d=new D.data.Info;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.text=e.string();break}case 2:{d.season=e.int32();break}case 3:{d.episode=e.int32();break}case 4:{d.frameStart=e.int32();break}case 5:{d.framePrefer=e.int32();break}case 6:{d.frameEnd=e.int32();break}case 7:{d.segmentId=e.int32();break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof j||(e=new j(e)),this.decode(e,e.uint32())},l.verify=function(e){return typeof e!="object"||e===null?"object expected":e.text!=null&&e.hasOwnProperty("text")&&!L.isString(e.text)?"text: string expected":e.season!=null&&e.hasOwnProperty("season")&&!L.isInteger(e.season)?"season: integer expected":e.episode!=null&&e.hasOwnProperty("episode")&&!L.isInteger(e.episode)?"episode: integer expected":e.frameStart!=null&&e.hasOwnProperty("frameStart")&&!L.isInteger(e.frameStart)?"frameStart: integer expected":e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&!L.isInteger(e.framePrefer)?"framePrefer: integer expected":e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&!L.isInteger(e.frameEnd)?"frameEnd: integer expected":e.segmentId!=null&&e.hasOwnProperty("segmentId")&&!L.isInteger(e.segmentId)?"segmentId: integer expected":null},l.fromObject=function(e){if(e instanceof D.data.Info)return e;let t=new D.data.Info;return e.text!=null&&(t.text=String(e.text)),e.season!=null&&(t.season=e.season|0),e.episode!=null&&(t.episode=e.episode|0),e.frameStart!=null&&(t.frameStart=e.frameStart|0),e.framePrefer!=null&&(t.framePrefer=e.framePrefer|0),e.frameEnd!=null&&(t.frameEnd=e.frameEnd|0),e.segmentId!=null&&(t.segmentId=e.segmentId|0),t},l.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.text="",n.season=0,n.episode=0,n.frameStart=0,n.framePrefer=0,n.frameEnd=0,n.segmentId=0),e.text!=null&&e.hasOwnProperty("text")&&(n.text=e.text),e.season!=null&&e.hasOwnProperty("season")&&(n.season=e.season),e.episode!=null&&e.hasOwnProperty("episode")&&(n.episode=e.episode),e.frameStart!=null&&e.hasOwnProperty("frameStart")&&(n.frameStart=e.frameStart),e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&(n.framePrefer=e.framePrefer),e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&(n.frameEnd=e.frameEnd),e.segmentId!=null&&e.hasOwnProperty("segmentId")&&(n.segmentId=e.segmentId),n},l.prototype.toJSON=function(){return this.constructor.toObject(this,q.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Info"},l}(),p.Data=function(){function l(a){if(this.info=[],a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.info=L.emptyArray,l.create=function(e){return new l(e)},l.encode=function(e,t){if(t||(t=Ie.create()),e.info!=null&&e.info.length)for(let n=0;n<e.info.length;++n)D.data.Info.encode(e.info[n],t.uint32(10).fork()).ldelim();return t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof j||(e=j.create(e));let n=t===void 0?e.len:e.pos+t,d=new D.data.Data;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.info&&d.info.length||(d.info=[]),d.info.push(D.data.Info.decode(e,e.uint32()));break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof j||(e=new j(e)),this.decode(e,e.uint32())},l.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.info!=null&&e.hasOwnProperty("info")){if(!Array.isArray(e.info))return"info: array expected";for(let t=0;t<e.info.length;++t){let n=D.data.Info.verify(e.info[t]);if(n)return"info."+n}}return null},l.fromObject=function(e){if(e instanceof D.data.Data)return e;let t=new D.data.Data;if(e.info){if(!Array.isArray(e.info))throw TypeError(".data.Data.info: array expected");t.info=[];for(let n=0;n<e.info.length;++n){if(typeof e.info[n]!="object")throw TypeError(".data.Data.info: object expected");t.info[n]=D.data.Info.fromObject(e.info[n])}}return t},l.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.info=[]),e.info&&e.info.length){n.info=[];for(let d=0;d<e.info.length;++d)n.info[d]=D.data.Info.toObject(e.info[d],t)}return n},l.prototype.toJSON=function(){return this.constructor.toObject(this,q.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Data"},l}(),p})(),ut={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},dt="https://mypic.0m0.uk/images/",ct=R({__name:"GifDialog",props:{text:{},season:{},episode:{},frameStart:{},frameEnd:{}},setup(p,{expose:l}){const a=p,e=y(!1),t=y(!1),n=y(""),d=y(!1),u=y(!1),f=y(!1),s=y(""),c=y(null),i=y(null);async function E(h){return new Promise((m,V)=>{const x=new Image;x.crossOrigin="Anonymous",x.onload=()=>{const S=document.createElement("canvas"),M=S.getContext("2d",{alpha:!1,willReadFrequently:!0});S.width=x.width,S.height=x.height,M==null||M.drawImage(x,0,0),m(x)},x.onerror=V,x.src=h})}async function $(){if(!c.value)return;const h=document.createElement("a");h.href=URL.createObjectURL(c.value),h.download=`${a.text}.gif`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(h.href)}async function ie(){const h=new File([c.value],"download.gif",{type:"image/gif"}),m=new FormData;m.append("image",h),m.append("title",a.text);const S=(await(await fetch("https://api.imgur.com/3/image",{method:"POST",headers:{Authorization:"Client-ID b3c5e3525785e29"},body:m})).json()).data.link;if(!S)throw new Error("Upload failed");return S}async function se(){if(!c.value)return;f.value=!0;const h=new ClipboardItem({"text/plain":(async()=>{try{if(i.value)return new Blob([i.value],{type:"text/plain"});n.value="正在上傳GIF...",t.value=!0;const m=await ie();return i.value=m,new Blob([m],{type:"text/plain"})}catch(m){throw console.error("GIF upload failed:",m),n.value="GIF 上傳失敗",G(m),m}})()});try{await navigator.clipboard.write([h]),n.value="GIF 連結複製成功"}catch(m){console.error("Clipboard write failed:",m),n.value="GIF 連結複製失敗",G(m)}finally{t.value=!0,f.value=!1}}async function ee(){if(d.value)return;if(c.value){e.value=!0;return}i.value=null,d.value=!0,n.value="GIF生成中...",t.value=!0;const h=performance.now();try{const m=new ot({workers:2,quality:10,workerScript:"/gif.worker.js"}),x=Array.from({length:a.frameEnd-a.frameStart-4},(_,A)=>a.frameStart+A+2).map(_=>{const A=`${dt}${a.season}/${a.episode}/${_}.webp`;return E(A)}),S=await Promise.all(x),M=Math.round(1e3/23.976);S.forEach(_=>{m.addFrame(_,{delay:M})}),m.on("finished",_=>{c.value=_,s.value=URL.createObjectURL(_);const W=((performance.now()-h)/1e3).toFixed(1);d.value=!1,n.value=`GIF生成完成 (${W}秒)`,t.value=!0,e.value=!0}),m.on("error",_=>{G(_),d.value=!1,n.value="GIF生成失敗",t.value=!0}),m.render()}catch(m){G(m),d.value=!1,n.value="GIF生成失敗",t.value=!0}}async function G(h){const m={content:`Copy failed: ${h.name}

${navigator.userAgent}

${h.message}

${h.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(ae.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})}catch(V){console.error("Failed to send error report to Discord:",V)}}return l({CreateGif:ee}),(h,m)=>(I(),K(pe,null,[o(X,{modelValue:e.value,"onUpdate:modelValue":m[0]||(m[0]=V=>e.value=V),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(Y,null,{default:r(()=>[o(Pe,{src:s.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),o(le,null,{default:r(()=>[o(Z,null,{default:r(()=>[o(O,{onClick:$,loading:u.value},{default:r(()=>m[2]||(m[2]=[k("下載")])),_:1},8,["loading"]),o(O,{onClick:se,loading:f.value},{default:r(()=>m[3]||(m[3]=[k("生成連結")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(me,{modelValue:t.value,"onUpdate:modelValue":m[1]||(m[1]=V=>t.value=V),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",ut,U(n.value),1)]),_:1},8,["modelValue"])],64))}}),ft={style:{position:"relative"},class:"size"},pt=["src","alt"],mt={style:{position:"relative"}},vt={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},yt="https://mypic.0m0.uk/images/",wt=R({__name:"CardComponent",props:{styles:{type:Object,required:!0},cardData:{type:Object,required:!0}},setup(p){const l=Me(),a=y(null),e=p,t=e.cardData.text,n=e.cardData.season,d=e.cardData.episode,u=e.cardData.frameStart,f=e.cardData.framePrefer,s=n==2?"Ave Mujica":"MyGO",c=`${s} 第${d}話`,i=`${d}`,E=ae.videoLink[s][i],$=[0,0,34288,68333,0,0,0,0,0,0,0,0,0,0],ie=Math.round((e.cardData.frameStart+(n==1?$[d]:0))/23.976),se=`${E}&t=${ie}s`,ee=u/23.976,G=`${Math.floor(ee/60)}:${("0"+Math.floor(ee%60)).slice(-2)}`,h=N(()=>`${yt}${n}/${d}/${f}.webp`),m=y(!1),V=y(!1),x=y("連結複製成功"),S=y(!1),M=y(!1);async function _(){if(!S.value){S.value=!0,x.value="下載中...",V.value=!0;try{const g=await ge(),T=await(await fetch(g)).blob(),F=URL.createObjectURL(T),P=document.createElement("a");P.href=F,P.download=`${t}.png`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(F),x.value="下載完成"}catch(g){ue(g),x.value="下載失敗"}finally{S.value=!1,V.value=!0}}}var A=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);let W=!1;const we=async g=>{if(W&&!g){W=!1;return}if(g&&(W=!0,A)){x.value="因瀏覽器限制，不支援長按複製連結",V.value=!0;return}if(M.value)return;M.value=!0,V.value=!1;const v=g||l.copyMode;try{v?await he():await Te()}catch(T){if(ue(T),A)x.value="複製失敗，請稍後重試，或切換為複製連結";else try{await he(),x.value="複製圖片失敗，已複製連結"}catch(F){console.error("Error during copy:",F.message),x.value="失敗 請按左下角回報手機型號/瀏覽器",ue(F)}}finally{M.value=!1,V.value=!0}},he=async()=>{await navigator.clipboard.writeText(h.value),x.value="連結複製成功"},Te=async()=>{const g=new ClipboardItem({"image/png":(async()=>{const v=await ge();return await(await fetch(v)).blob()})()});await navigator.clipboard.write([g]),x.value="圖片複製成功"},Ue=(()=>{const g=document.createElement("canvas"),v=g.getContext("2d",{alpha:!1,willReadFrequently:!0})??new CanvasRenderingContext2D;return{canvas:g,ctx:v}})();var te="";async function ge(){if(te)return te;let g=new Image;g.src=h.value,g.crossOrigin="Anonymous",g.style.display="none",await new Promise(F=>{g.onload=F});const{canvas:v,ctx:T}=Ue;return v.width=g.width,v.height=g.height,T.drawImage(g,0,0),te=v.toDataURL("image/png"),te}async function ue(g){const v={content:`Copy failed: ${g.name}

${navigator.userAgent}

${g.message}

${g.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(ae.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})}catch(T){console.error("Failed to send error report to Discord:",T)}}return(g,v)=>{const T=De,F=$e("long-press");return I(),K("div",{style:Se(p.styles)},[o(Y,{class:"card size",color:"surface-variant",rounded:"lg",variant:"tonal",onClick:v[0]||(v[0]=P=>m.value=!0)},{default:r(()=>[b("div",ft,[b("img",{src:h.value,class:"size",alt:w(t)},null,8,pt),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},U(c)+" "+U(G))]),o(ce,{class:"card-text text-center justify-center"},{default:r(()=>[k(U(w(t)),1)]),_:1})]),_:1}),o(X,{modelValue:m.value,"onUpdate:modelValue":v[3]||(v[3]=P=>m.value=P),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(Y,null,{default:r(()=>[b("div",mt,[o(Pe,{src:h.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},U(c)+" "+U(G))]),o(Z,null,{default:r(()=>[o(Q,null,{default:r(()=>[o(ce,{class:"text-center"},{default:r(()=>[k(U(w(t)),1)]),_:1})]),_:1})]),_:1}),o(le,null,{default:r(()=>[o(Z,null,{default:r(()=>[o(O,null,{default:r(()=>[v[5]||(v[5]=k(" 回報 ")),o(T,{fileName:h.value,text:w(t)},null,8,["fileName","text"])]),_:1}),o(O,{onClick:_,loading:S.value},{default:r(()=>v[6]||(v[6]=[k("下載")])),_:1},8,["loading"]),o(O,{onClick:v[1]||(v[1]=()=>{var P;return(P=a.value)==null?void 0:P.CreateGif()})},{default:r(()=>v[7]||(v[7]=[k("GIF")])),_:1}),Fe((I(),C(O,{onClick:v[2]||(v[2]=()=>we(!1)),loading:M.value},{default:r(()=>v[8]||(v[8]=[k("複製")])),_:1},8,["loading"])),[[F,()=>we(!0)]]),o(O,{href:se,target:"_blank"},{default:r(()=>v[9]||(v[9]=[k(" 從這裡開始看 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ct,{ref_key:"gifDialogRef",ref:a,text:w(t),season:w(n),episode:w(d),"frame-start":w(u),"frame-end":e.cardData.frameEnd},null,8,["text","season","episode","frame-start","frame-end"]),o(me,{modelValue:V.value,"onUpdate:modelValue":v[4]||(v[4]=P=>V.value=P),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",vt,U(x.value),1)]),_:1},8,["modelValue"])],4)}}}),_e=(p,l)=>{const a=p.__vccOpts||p;for(const[e,t]of l)a[e]=t;return a},ht=_e(wt,[["__scopeId","data-v-40fbedcd"]]);var gt=st.Data;const Ve=p=>p.toLowerCase().replace("你","妳").replace("啊","阿"),bt=()=>tt(at,nt),ve=re("Reverse",{state:()=>({reverse:!1})}),Me=re("CopyMode",{state:()=>({copyMode:!1})}),ye=re("Query",()=>{const p=y(""),l=y([]),a=y([]),e=y(0),t=()=>{const n=new URL(window.location.href);p.value===""?n.searchParams.delete("q"):n.searchParams.set("q",p.value);for(var d=0,u=1;u<14;u++)d|=+l.value.includes(u)<<u-1;for(var u=1;u<9;u++)d|=+a.value.includes(u)<<u+12;d==0?n.searchParams.delete("ep"):n.searchParams.set("ep",d.toString()),window.history.pushState({},"",n.toString())};return J(p,t),J(l,t),J(a,t),J(e,t),{query:p,mygoFilter:l,avemujicaFilter:a,characterFilter:e}}),xt=re("Data",()=>{const p=y([]),l=ye(),a=ve();a.$subscribe(()=>{p.value.reverse()});const e=bt();var t=new Map;const n=N(()=>{if(p.value.length===0)return[];var u=p.value,f=new Set;if(l.mygoFilter.forEach(s=>{f.add(`1-${s}`)}),l.avemujicaFilter.forEach(s=>{f.add(`2-${s}`)}),f.size!==0){const s=a.reverse+Array.from(f).join("");t.has(s)?u=t.get(s)??[]:(u=p.value.filter(c=>f.has(`${c.season}-${c.episode}`)),t.set(s,u))}if(l.query==="")return u;{const s=e(Ve(l.query));return u.filter(c=>Ve(c.text).includes(s))}});return{cardsData:p,fetchData:async()=>{if(p.value.length===0){var u;try{var f=await(await fetch("/data/data.bin")).bytes();u=gt.decode(f).info}catch{u=[]}p.value=u,t.clear()}},filteredCards:n}}),kt={key:0,class:"ml-2 d-flex align-center"},It=R({__name:"FooterComponent",setup(p){const l=Me(),a=y(!0),e=N({get(){return n.global.current.value.dark},set(c){d(c)}}),t=N({get(){return l.copyMode},set(c){l.copyMode=c,localStorage.setItem("copyURLMode",c.toString())}}),n=qe();function d(c){n.global.name.value=c?"dark":"light",localStorage.setItem("darkTheme",n.global.name.value)}const u=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("firefox"),f=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("mobile"),s=()=>!(u()&&f());return oe(()=>{a.value=s(),a.value?localStorage.getItem("copyURLMode")?l.copyMode=localStorage.getItem("copyURLMode")==="true":l.copyMode=!1:l.copyMode=!0,localStorage.getItem("darkTheme")?n.global.name.value=localStorage.getItem("darkTheme")??"dark":window.matchMedia("(prefers-color-scheme: light)").matches&&(n.global.name.value="light")}),(c,i)=>{const E=De;return I(),C(ze,{app:""},{default:r(()=>[o(Ce,{fluid:"",style:{padding:"5px"}},{default:r(()=>[o(Z,null,{default:r(()=>[o(Q,null,{default:r(()=>[o(O,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[7]||(i[7]=k(" 其他連結 ")),o(Be,{activator:"parent",location:"center"},{default:r(()=>[o(Qe,null,{default:r(()=>[o(ne,{icon:`mdiSvg:${w(z)}`},null,8,["icon"]),(I(),C(B,{key:0,target:"_blank",value:0,"append-icon":w(z),href:"https://github.com/NightFeather0615/Its-MyPic-Android"},{default:r(()=>[o(H,null,{default:r(()=>i[2]||(i[2]=[k("Its-MyPic for Android")])),_:1})]),_:1},8,["append-icon"])),(I(),C(B,{key:1,target:"_blank",value:1,"append-icon":w(z),href:"https://github.com/Its-MyPic/PowerToys-Run-Its-MyPic"},{default:r(()=>[o(H,null,{default:r(()=>i[3]||(i[3]=[k("PowerToys-Run Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),C(B,{key:2,target:"_blank",value:2,"append-icon":w(z),href:"https://github.com/Its-MyPic/krunner-Its-MyPic"},{default:r(()=>[o(H,null,{default:r(()=>i[4]||(i[4]=[k("Krunner Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),C(B,{key:3,target:"_blank",value:3,"append-icon":w(z),href:"https://github.com/Its-MyPic/Its-MyPic-vue"},{default:r(()=>[o(H,null,{default:r(()=>i[5]||(i[5]=[k("這個網頁的原始碼")])),_:1})]),_:1},8,["append-icon"])),(I(),C(B,{key:4,target:"_blank",value:4,"append-icon":w(z),href:"https://github.com/Its-MyPic/Its-MyPicDB"},{default:r(()=>[o(H,null,{default:r(()=>i[6]||(i[6]=[k("mygo系列的截圖資料")])),_:1})]),_:1},8,["append-icon"]))]),_:1})]),_:1})]),_:1}),o(O,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[8]||(i[8]=k(" 回報問題 ")),o(E)]),_:1}),o(O,{variant:"text",size:"small",class:"text-center",href:"https://forms.gle/WzW9PZwUU6gqHZko7",target:"_blank"},{default:r(()=>i[9]||(i[9]=[k(" 投稿 ")])),_:1})]),_:1}),o(Q,{cols:"1"},{default:r(()=>[o(O,{variant:"text",size:"small",density:"comfortable",icon:w(ke)},{default:r(()=>[o(ne,{icon:w(ke),"aria-label":"設定"},null,8,["icon"]),o(X,{activator:"parent","max-width":"600px",style:{maxHeight:"90vh",minHeight:"200px"}},{default:r(()=>[o(Y,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[i[14]||(i[14]=b("br",null,null,-1)),i[15]||(i[15]=b("span",{class:"ml-2 d-flex align-center"},"主題",-1)),o(Q,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[10]||(i[10]=b("span",{class:"mr-2 d-flex align-center"},"淺色",-1)),o(be,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=$=>e.value=$),class:"mx-2 d-flex align-center"},null,8,["modelValue"]),i[11]||(i[11]=b("span",{class:"ml-2 d-flex align-center"},"深色",-1))]),_:1}),i[16]||(i[16]=b("br",null,null,-1)),i[17]||(i[17]=b("span",{class:"ml-2 d-flex align-center"},"偏好複製模式",-1)),o(Q,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[12]||(i[12]=b("span",{class:"mr-2 d-flex align-center"},"複製圖片",-1)),o(be,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=$=>t.value=$),class:"mx-2 d-flex align-center",disabled:!a.value},null,8,["modelValue","disabled"]),i[13]||(i[13]=b("span",{class:"ml-2 d-flex align-center"},"複製連結",-1))]),_:1}),a.value?de("",!0):(I(),K("span",kt,"您的瀏覽器不支援複製圖片")),i[18]||(i[18]=b("br",null,null,-1))]),_:1})]),_:1})]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),Vt=R({__name:"ResultGrid",setup(p){const l=ve(),a=xt();a.fetchData();const{filteredCards:e}=et(a);let t=y(4);const n=()=>{t.value=(1+Math.floor((window.innerWidth-320)/310))*8},d=N(()=>{typeof window<"u"&&window.scrollTo({top:0,left:0,behavior:"smooth"});const f=e.value;return l.reverse,(s,c)=>{const i=f.slice(s*c,(s+1)*c);return Promise.resolve(i)}}),u=f=>{var s;return(s=f.value)==null?void 0:s.segmentId};return oe(()=>{n(),window.addEventListener("resize",n)}),Re(()=>{window.removeEventListener("resize",n)}),(f,s)=>(I(),C(Ee,null,{default:r(()=>[o(w(lt),{length:w(e).length?w(e).length:1,pageSize:w(t),pageProvider:d.value,"get-key":u,"page-provider-debounce-time":100,class:"grid ma-5"},{placeholder:r(({index:c,style:i})=>[b("div",{class:"item",style:Se(i)},U(w(e).length?"還在GO...":""),5)]),default:r(({item:c,style:i,index:E})=>[o(ht,{styles:i,cardData:c},null,8,["styles","cardData"])]),_:1},8,["length","pageSize","pageProvider"])]),fallback:r(()=>s[0]||(s[0]=[b("p",null,"Loading...",-1)])),_:1}))}}),Ot=_e(Vt,[["__scopeId","data-v-e1182e96"]]),Oe=R({__name:"MultiSelect",props:je({items:{type:Array,required:!0},label:{type:String,required:!1,default:"Select"}},{modelValue:{type:Array,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const l=p,a=Le(p,"modelValue"),e=N(()=>a.value.length===l.items.length),t=N(()=>a.value.length>0&&a.value.length<l.items.length),n=()=>{e.value?a.value=[]:a.value=[...l.items]};return J(a,()=>{a.value.sort()}),(d,u)=>(I(),C(He,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f),label:p.label,variant:"outlined",multiple:"",items:p.items,style:{"min-width":"250px"}},{"prepend-item":r(()=>[o(B,{title:"全選",onClick:n},{prepend:r(()=>[o(Ye,{indeterminate:t.value,"model-value":e.value},null,8,["indeterminate","model-value"])]),_:1}),o(We,{class:"mt-2"})]),selection:r(({item:f,index:s})=>[a.value.length!=p.items.length?(I(),C(xe,{key:0},{default:r(()=>[b("span",null,U(f.value),1)]),_:2},1024)):de("",!0),s===p.items.length-1?(I(),C(xe,{key:1},{default:r(()=>u[1]||(u[1]=[b("span",null,"全選",-1)])),_:1})):de("",!0)]),_:1},8,["modelValue","label","items"]))}}),St=R({__name:"FilterDialog",setup(p){const l=ye(),a=y(!1),e=y([]),t=y([]),n=y([]),d=()=>{t.value=[],n.value=[],e.value=[]},u=()=>{l.mygoFilter=t.value,l.avemujicaFilter=n.value,l.characterFilter=0,a.value=!1};return oe(()=>{const s=new URLSearchParams(window.location.search).get("ep");if(s){for(var c=+s,i=0;c&&i<13;i++){const E=c&1;c=c>>1,E&&t.value.push(i+1)}for(var i=0;c&&i<13;i++){const $=c&1;c=c>>1,$&&n.value.push(i+1)}u()}}),(f,s)=>(I(),C(X,{modelValue:a.value,"onUpdate:modelValue":s[2]||(s[2]=c=>a.value=c),"max-width":"600px",style:{"min-height":"600px"},transition:"dialog-top-transition"},{activator:r(({props:c})=>[o(ne,Ge(c,{icon:w(Ze)}),null,16,["icon"])]),default:r(()=>[o(Y,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[s[3]||(s[3]=b("br",null,null,-1)),s[4]||(s[4]=b("br",null,null,-1)),s[5]||(s[5]=b("span",{class:"align-center"},"集數篩選",-1)),o(Oe,{items:Array.from({length:13},(c,i)=>i+1),modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=c=>t.value=c),label:"MyGO",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(Oe,{items:Array.from({length:12},(c,i)=>i+1),modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=c=>n.value=c),label:"Ave Mujica",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(le,null,{default:r(()=>[o(O,{class:"text-center",text:"清除篩選",onClick:d}),o(O,{class:"text-center",text:"確定",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Pt=R({__name:"AppBarComponent",setup(p){const l=ve(),a=ye(),e=y(),t=y(""),n=()=>{clearTimeout(e.value),e.value=setTimeout(d,500)},d=()=>{clearTimeout(e.value),a.query=t.value},u=()=>{t.value="",a.query=""};return oe(()=>{const s=new URLSearchParams(window.location.search).get("q");s&&(t.value=s,a.query=s)}),(f,s)=>{const c=St;return I(),C(Je,{density:"prominent"},{default:r(()=>[o(Ce,null,{default:r(()=>[s[2]||(s[2]=b("div",{class:"text-h5 mx-auto font-weight-bold text-center text-truncate"}," MyGO Mujica 截圖搜尋器 ",-1)),o(Z,{dense:"",class:"mt-2"},{default:r(()=>[o(Q,{class:"text-center"},{default:r(()=>[o(fe,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value=i),"single-line":"","hide-details":"",clearable:"",label:"搜尋",variant:"outlined",class:"short-search",onKeyup:Ae(d,["enter"]),"onClick:clear":u,onInput:n,autofocus:""},{append:r(()=>[o(ne,{onClick:s[0]||(s[0]=i=>w(l).reverse=!w(l).reverse),icon:w(l).reverse?w(Ke):w(Xe)},null,8,["icon"])]),"append-inner":r(()=>[o(c)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),jt=R({__name:"index",setup(p){return(l,a)=>{const e=Pt,t=Ot,n=It;return I(),K(pe,null,[o(e),o(t),o(n,{style:{width:"100%"}})],64)}}});export{jt as default};
