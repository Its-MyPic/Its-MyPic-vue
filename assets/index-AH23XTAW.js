import{k as U,r as y,D as I,I as H,X as o,F as r,a5 as k,a7 as b,J as me,w as Y,c as j,l as le,E as P,u as w,a8 as ce,$,a2 as Ue,B as Me,L as Oe,O as Re,a9 as Ee,aa as Le,ab as je,Y as Ge,ac as Ae}from"./@vue-CNCR8Vmv.js";import{e as B,f as Ne,g as fe,h as pe,i as re,j as S,k as J,l as ve,u as qe,n as ze,o as W,p as z,q as Be,r as Qe,s as ne,t as q,v as Q,w as be,x as Pe,y as Ce,z as Ye,A as We,B as xe,C as He,D as Je}from"./vuetify-BEJceuSt.js";import{m as N,a as ke,b as Ze,c as Ke,d as Xe}from"./@mdi-DKC2W5MC.js";import{d as ie,s as et}from"./pinia-CqnXpMGa.js";import{m as G}from"./protobufjs-CgPuVhCO.js";import{f as tt,F as at}from"./@ffmpeg-B1ncfXmI.js";import{C as nt,t as ot,c as lt}from"./opencc-js-D-mJJ3do.js";import{G as rt}from"./vue-virtual-scroll-grid-DXBkyr0D.js";import"./@protobufjs-f4nnaicZ.js";const it="MTMzNTEwMzQ1NzY4MTczNTc2MC9LT0lwZ2FDc3RmRURnVHVqR2dEYmVYWWZSLUdZRjVQQ29veXZ0TFVGbFhFM0tYdGRGTzhHR3RrTXptWEp4R3FxQVI5bw==",st={MyGO:{1:"https://www.youtube.com/watch?v=WOrYBIYIwyk",2:"https://www.youtube.com/watch?v=WOrYBIYIwyk",3:"https://www.youtube.com/watch?v=WOrYBIYIwyk",4:"https://www.youtube.com/watch?v=ijdspfPMzYc",5:"https://www.youtube.com/watch?v=zfA0zRAkAdk",6:"https://www.youtube.com/watch?v=UwgyEoB9vU8",7:"https://www.youtube.com/watch?v=rlY2b3TIYPs",8:"https://www.youtube.com/watch?v=mfboDpl88QY",9:"https://www.youtube.com/watch?v=ySjYENzyZmY",10:"https://www.youtube.com/watch?v=bLWDIYpGcEI",11:"https://www.youtube.com/watch?v=gAFDVnhX24o",12:"https://www.youtube.com/watch?v=wei3payuSi8",13:"https://www.youtube.com/watch?v=uQ3_PvPCNnI"},"Ave Mujica":{1:"https://www.youtube.com/watch?v=dxmmSFQxWzM",2:"https://www.youtube.com/watch?v=Bzl61esi4qc",3:"https://www.youtube.com/watch?v=HagaJboujK4",4:"https://www.youtube.com/watch?v=Z6cOxtDsfNU",5:"https://www.youtube.com/watch?v=7D2uGv7aprQ",6:"https://www.youtube.com/watch?v=jQraN1emvLQ",7:"https://www.youtube.com/watch?v=RONGNWb7OpQ",8:"https://www.youtube.com/watch?v=uh9jUhVTS28",9:"https://www.youtube.com/watch?v=pGrI6hk0vBg",10:"https://www.youtube.com/watch?v=m9cjOcCKIyQ",11:"https://www.youtube.com/watch?v=Cfm8TWGkvYQ",12:"https://www.youtube.com/watch?v=UtSEFdDZZLw"}},oe={webhook:it,videoLink:st},_e=U({__name:"ReportDialog",props:{fileName:{type:String,required:!1,default:""},text:{type:String,required:!1,default:""}},setup(m){const l=m,a=y(""),e=y(""),t=y(!1),n=y(!1);async function d(){let u="";if(a.value&&(u+=`問題: ${a.value}
`),e.value&&(u+=`聯絡方式: ${e.value}
`),l.fileName&&(u+=`檔案名稱: ${l.fileName}
`),l.text&&(u+=`文字: ${l.text}
`),u){const f={content:u};await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),t.value=!0}n.value=!1}return(u,f)=>(I(),H(me,null,[o(J,{modelValue:n.value,"onUpdate:modelValue":f[2]||(f[2]=s=>n.value=s),activator:"parent","max-width":"600px",style:{maxHeight:"90vh"},transition:"dialog-bottom-transition"},{default:r(()=>[o(B,null,{default:r(()=>[o(Ne,null,{default:r(()=>f[4]||(f[4]=[k("回報問題")])),_:1}),o(fe,null,{default:r(()=>[o(pe,{label:"你遭遇到的問題(選填)",modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=s=>a.value=s),outlined:""},null,8,["modelValue"]),o(pe,{label:"你的聯絡方式(選填)",modelValue:e.value,"onUpdate:modelValue":f[1]||(f[1]=s=>e.value=s),outlined:""},null,8,["modelValue"])]),_:1}),o(re,null,{default:r(()=>[o(S,{onClick:d},{default:r(()=>f[5]||(f[5]=[k("送出")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ve,{modelValue:t.value,"onUpdate:modelValue":f[3]||(f[3]=s=>t.value=s),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>f[6]||(f[6]=[b("div",{class:"text-h6 mx-auto font-weight-bold text-center text-truncate"}," 已回報問題 ",-1)])),_:1},8,["modelValue"])],64))}}),M=G.Reader,Ie=G.Writer,R=G.util,_=G.roots.default||(G.roots.default={}),ut=_.data=(()=>{const m={};return m.Info=function(){function l(a){if(a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.text="",l.prototype.season=0,l.prototype.episode=0,l.prototype.frameStart=0,l.prototype.framePrefer=0,l.prototype.frameEnd=0,l.prototype.segmentId=0,l.create=function(e){return new l(e)},l.encode=function(e,t){return t||(t=Ie.create()),e.text!=null&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),e.season!=null&&Object.hasOwnProperty.call(e,"season")&&t.uint32(16).int32(e.season),e.episode!=null&&Object.hasOwnProperty.call(e,"episode")&&t.uint32(24).int32(e.episode),e.frameStart!=null&&Object.hasOwnProperty.call(e,"frameStart")&&t.uint32(32).int32(e.frameStart),e.framePrefer!=null&&Object.hasOwnProperty.call(e,"framePrefer")&&t.uint32(40).int32(e.framePrefer),e.frameEnd!=null&&Object.hasOwnProperty.call(e,"frameEnd")&&t.uint32(48).int32(e.frameEnd),e.segmentId!=null&&Object.hasOwnProperty.call(e,"segmentId")&&t.uint32(56).int32(e.segmentId),t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof M||(e=M.create(e));let n=t===void 0?e.len:e.pos+t,d=new _.data.Info;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.text=e.string();break}case 2:{d.season=e.int32();break}case 3:{d.episode=e.int32();break}case 4:{d.frameStart=e.int32();break}case 5:{d.framePrefer=e.int32();break}case 6:{d.frameEnd=e.int32();break}case 7:{d.segmentId=e.int32();break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof M||(e=new M(e)),this.decode(e,e.uint32())},l.verify=function(e){return typeof e!="object"||e===null?"object expected":e.text!=null&&e.hasOwnProperty("text")&&!R.isString(e.text)?"text: string expected":e.season!=null&&e.hasOwnProperty("season")&&!R.isInteger(e.season)?"season: integer expected":e.episode!=null&&e.hasOwnProperty("episode")&&!R.isInteger(e.episode)?"episode: integer expected":e.frameStart!=null&&e.hasOwnProperty("frameStart")&&!R.isInteger(e.frameStart)?"frameStart: integer expected":e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&!R.isInteger(e.framePrefer)?"framePrefer: integer expected":e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&!R.isInteger(e.frameEnd)?"frameEnd: integer expected":e.segmentId!=null&&e.hasOwnProperty("segmentId")&&!R.isInteger(e.segmentId)?"segmentId: integer expected":null},l.fromObject=function(e){if(e instanceof _.data.Info)return e;let t=new _.data.Info;return e.text!=null&&(t.text=String(e.text)),e.season!=null&&(t.season=e.season|0),e.episode!=null&&(t.episode=e.episode|0),e.frameStart!=null&&(t.frameStart=e.frameStart|0),e.framePrefer!=null&&(t.framePrefer=e.framePrefer|0),e.frameEnd!=null&&(t.frameEnd=e.frameEnd|0),e.segmentId!=null&&(t.segmentId=e.segmentId|0),t},l.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.text="",n.season=0,n.episode=0,n.frameStart=0,n.framePrefer=0,n.frameEnd=0,n.segmentId=0),e.text!=null&&e.hasOwnProperty("text")&&(n.text=e.text),e.season!=null&&e.hasOwnProperty("season")&&(n.season=e.season),e.episode!=null&&e.hasOwnProperty("episode")&&(n.episode=e.episode),e.frameStart!=null&&e.hasOwnProperty("frameStart")&&(n.frameStart=e.frameStart),e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&(n.framePrefer=e.framePrefer),e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&(n.frameEnd=e.frameEnd),e.segmentId!=null&&e.hasOwnProperty("segmentId")&&(n.segmentId=e.segmentId),n},l.prototype.toJSON=function(){return this.constructor.toObject(this,G.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Info"},l}(),m.Data=function(){function l(a){if(this.info=[],a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.info=R.emptyArray,l.create=function(e){return new l(e)},l.encode=function(e,t){if(t||(t=Ie.create()),e.info!=null&&e.info.length)for(let n=0;n<e.info.length;++n)_.data.Info.encode(e.info[n],t.uint32(10).fork()).ldelim();return t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof M||(e=M.create(e));let n=t===void 0?e.len:e.pos+t,d=new _.data.Data;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.info&&d.info.length||(d.info=[]),d.info.push(_.data.Info.decode(e,e.uint32()));break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof M||(e=new M(e)),this.decode(e,e.uint32())},l.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.info!=null&&e.hasOwnProperty("info")){if(!Array.isArray(e.info))return"info: array expected";for(let t=0;t<e.info.length;++t){let n=_.data.Info.verify(e.info[t]);if(n)return"info."+n}}return null},l.fromObject=function(e){if(e instanceof _.data.Data)return e;let t=new _.data.Data;if(e.info){if(!Array.isArray(e.info))throw TypeError(".data.Data.info: array expected");t.info=[];for(let n=0;n<e.info.length;++n){if(typeof e.info[n]!="object")throw TypeError(".data.Data.info: object expected");t.info[n]=_.data.Info.fromObject(e.info[n])}}return t},l.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.info=[]),e.info&&e.info.length){n.info=[];for(let d=0;d<e.info.length;++d)n.info[d]=_.data.Info.toObject(e.info[d],t)}return n},l.prototype.toJSON=function(){return this.constructor.toObject(this,G.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Data"},l}(),m})();var dt=ut.Data;const Ve=m=>m.toLowerCase().replace("你","妳").replace("啊","阿"),ct=()=>nt(lt,ot),ye=ie("Reverse",{state:()=>({reverse:!1})}),De=ie("CopyMode",{state:()=>({copyMode:!1})}),we=ie("Query",()=>{const m=y(""),l=y([]),a=y([]),e=y(0),t=()=>{const n=new URL(window.location.href);m.value===""?n.searchParams.delete("q"):n.searchParams.set("q",m.value);for(var d=0,u=1;u<14;u++)d|=+l.value.includes(u)<<u-1;for(var u=1;u<9;u++)d|=+a.value.includes(u)<<u+12;d==0?n.searchParams.delete("ep"):n.searchParams.set("ep",d.toString()),window.history.pushState({},"",n.toString())};return Y(m,t),Y(l,t),Y(a,t),Y(e,t),{query:m,mygoFilter:l,avemujicaFilter:a,characterFilter:e}}),ft=ie("Data",()=>{const m=y([]),l=we(),a=ye();a.$subscribe(()=>{m.value.reverse()});const e=ct();var t=new Map;const n=j(()=>{if(m.value.length===0)return[];var u=m.value,f=new Set;if(l.mygoFilter.forEach(s=>{f.add(`1-${s}`)}),l.avemujicaFilter.forEach(s=>{f.add(`2-${s}`)}),f.size!==0){const s=a.reverse+Array.from(f).join("");t.has(s)?u=t.get(s)??[]:(u=m.value.filter(c=>f.has(`${c.season}-${c.episode}`)),t.set(s,u))}if(l.query==="")return u;{const s=e(Ve(l.query));return u.filter(c=>Ve(c.text).includes(s))}});return{cardsData:m,fetchData:async()=>{if(m.value.length===0){var u;try{var f=await(await fetch("/data/data.bin")).bytes();u=dt.decode(f).info}catch{u=[]}m.value=u,t.clear()}},filteredCards:n}}),pt={key:0,class:"ml-2 d-flex align-center"},mt=U({__name:"FooterComponent",setup(m){const l=De(),a=y(!0),e=j({get(){return n.global.current.value.dark},set(c){d(c)}}),t=j({get(){return l.copyMode},set(c){l.copyMode=c,localStorage.setItem("copyURLMode",c.toString())}}),n=qe();function d(c){n.global.name.value=c?"dark":"light",localStorage.setItem("darkTheme",n.global.name.value)}const u=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("firefox"),f=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("mobile"),s=()=>!(u()&&f());return le(()=>{a.value=s(),a.value?localStorage.getItem("copyURLMode")?l.copyMode=localStorage.getItem("copyURLMode")==="true":l.copyMode=!1:l.copyMode=!0,localStorage.getItem("darkTheme")?n.global.name.value=localStorage.getItem("darkTheme")??"dark":window.matchMedia("(prefers-color-scheme: light)").matches&&(n.global.name.value="light")}),(c,i)=>{const V=_e;return I(),P(ze,{app:""},{default:r(()=>[o(Pe,{fluid:"",style:{padding:"5px"}},{default:r(()=>[o(W,null,{default:r(()=>[o(z,null,{default:r(()=>[o(S,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[7]||(i[7]=k(" 其他連結 ")),o(Be,{activator:"parent",location:"center"},{default:r(()=>[o(Qe,null,{default:r(()=>[o(ne,{icon:`mdiSvg:${w(N)}`},null,8,["icon"]),(I(),P(q,{key:0,target:"_blank",value:0,"append-icon":w(N),href:"https://github.com/NightFeather0615/Its-MyPic-Android"},{default:r(()=>[o(Q,null,{default:r(()=>i[2]||(i[2]=[k("Its-MyPic for Android")])),_:1})]),_:1},8,["append-icon"])),(I(),P(q,{key:1,target:"_blank",value:1,"append-icon":w(N),href:"https://github.com/Its-MyPic/PowerToys-Run-Its-MyPic"},{default:r(()=>[o(Q,null,{default:r(()=>i[3]||(i[3]=[k("PowerToys-Run Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),P(q,{key:2,target:"_blank",value:2,"append-icon":w(N),href:"https://github.com/Its-MyPic/krunner-Its-MyPic"},{default:r(()=>[o(Q,null,{default:r(()=>i[4]||(i[4]=[k("Krunner Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),P(q,{key:3,target:"_blank",value:3,"append-icon":w(N),href:"https://github.com/Its-MyPic/Its-MyPic-vue"},{default:r(()=>[o(Q,null,{default:r(()=>i[5]||(i[5]=[k("這個網頁的原始碼")])),_:1})]),_:1},8,["append-icon"])),(I(),P(q,{key:4,target:"_blank",value:4,"append-icon":w(N),href:"https://github.com/Its-MyPic/Its-MyPicDB"},{default:r(()=>[o(Q,null,{default:r(()=>i[6]||(i[6]=[k("mygo系列的截圖資料")])),_:1})]),_:1},8,["append-icon"]))]),_:1})]),_:1})]),_:1}),o(S,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[8]||(i[8]=k(" 回報問題 ")),o(V)]),_:1}),o(S,{variant:"text",size:"small",class:"text-center",href:"https://forms.gle/WzW9PZwUU6gqHZko7",target:"_blank"},{default:r(()=>i[9]||(i[9]=[k(" 投稿 ")])),_:1})]),_:1}),o(z,{cols:"1"},{default:r(()=>[o(S,{variant:"text",size:"small",density:"comfortable",icon:w(ke)},{default:r(()=>[o(ne,{icon:w(ke),"aria-label":"設定"},null,8,["icon"]),o(J,{activator:"parent","max-width":"600px",style:{maxHeight:"90vh",minHeight:"200px"}},{default:r(()=>[o(B,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[i[14]||(i[14]=b("br",null,null,-1)),i[15]||(i[15]=b("span",{class:"ml-2 d-flex align-center"},"主題",-1)),o(z,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[10]||(i[10]=b("span",{class:"mr-2 d-flex align-center"},"淺色",-1)),o(be,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=C=>e.value=C),class:"mx-2 d-flex align-center"},null,8,["modelValue"]),i[11]||(i[11]=b("span",{class:"ml-2 d-flex align-center"},"深色",-1))]),_:1}),i[16]||(i[16]=b("br",null,null,-1)),i[17]||(i[17]=b("span",{class:"ml-2 d-flex align-center"},"偏好複製模式",-1)),o(z,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[12]||(i[12]=b("span",{class:"mr-2 d-flex align-center"},"複製圖片",-1)),o(be,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=C=>t.value=C),class:"mx-2 d-flex align-center",disabled:!a.value},null,8,["modelValue","disabled"]),i[13]||(i[13]=b("span",{class:"ml-2 d-flex align-center"},"複製連結",-1))]),_:1}),a.value?ce("",!0):(I(),H("span",pt,"您的瀏覽器不支援複製圖片")),i[18]||(i[18]=b("br",null,null,-1))]),_:1})]),_:1})]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),vt={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},yt="https://mypic.0m0.uk/images/",wt=U({__name:"GifDialog",props:{text:{},season:{},episode:{},frameStart:{},frameEnd:{}},setup(m,{expose:l}){const a=new at;let e=!1;const t=m,n=y(!1),d=y(!1),u=y(""),f=y(!1),s=y(!1),c=y(!1),i=y(""),V=y(null),C=y(null);async function se(){e||(await a.load(),e=!0)}async function ue(){if(!V.value)return;const g=document.createElement("a");g.href=URL.createObjectURL(V.value),g.download=`${t.text}.gif`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(g.href)}async function Z(){const g=new File([V.value],"download.gif",{type:"image/gif"}),p=new FormData;p.append("fileToUpload",g),p.append("reqtype","fileupload");const x=await fetch("https://cors.0m0.uk/?https://catbox.moe/user/api.php",{method:"POST",body:p});if(x.status===413)throw new Error("GIF檔案過大，請自行下載後上傳至其他圖床");return await x.text()}async function K(){if(!V.value)return;c.value=!0;const g=new ClipboardItem({"text/plain":(async()=>{try{if(C.value)return new Blob([C.value],{type:"text/plain"});u.value="正在上傳GIF...",d.value=!0;const p=await Z();return C.value=p,new Blob([p],{type:"text/plain"})}catch(p){throw u.value=p instanceof Error?p.message:"GIF 上傳失敗",L(p),p}})()});try{await navigator.clipboard.write([g]),u.value="GIF 連結複製成功"}catch(p){p instanceof Error&&p.name==="NotAllowedError"?u.value="GIF 連結複製失敗":u.value=p instanceof Error?p.message:"GIF 上傳失敗",L(p)}finally{d.value=!0,c.value=!1}}async function E(){if(f.value)return;if(V.value){n.value=!0;return}C.value=null,f.value=!0,u.value="GIF生成中...",d.value=!0;const g=performance.now(),p=Array.from({length:t.frameEnd-t.frameStart-4},(x,D)=>t.frameStart+D+2);try{await se();const x=p.map(async A=>{const ee=`${yt}${t.season}/${t.episode}/${A}.webp`,te=await tt(ee);await a.writeFile(`${A}.webp`,te)});await Promise.all(x),await a.exec(["-start_number",p[0].toString(),"-i","%d.webp","-vf","palettegen","palette.png"]),await a.exec(["-start_number",p[0].toString(),"-i","%d.webp","-i","palette.png","-filter_complex","paletteuse=dither=none","-frames:v",p.length.toString(),"-f","gif","-framerate","24","output.gif"]);const D=await a.readFile("output.gif");V.value=new Blob([D],{type:"image/gif"}),i.value=URL.createObjectURL(V.value);const X=((performance.now()-g)/1e3).toFixed(1);u.value=`GIF生成完成 (${X}秒)`,n.value=!0}catch(x){console.error("GIF generation failed:",x),L(x),u.value="GIF生成失敗"}finally{f.value=!1,d.value=!0;const x=p.map(D=>a.deleteFile(`${D}.webp`).catch(console.error));await Promise.all([...x,a.deleteFile("output.gif").catch(console.error),a.deleteFile("palette.png").catch(console.error)])}}async function L(g){const p={content:`Copy failed: ${g.name}

${navigator.userAgent}

${g.message}

${g.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})}catch(x){console.error("Failed to send error report to Discord:",x)}}return l({CreateGif:E}),(g,p)=>(I(),H(me,null,[o(J,{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=x=>n.value=x),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(B,null,{default:r(()=>[o(Ce,{src:i.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),o(re,null,{default:r(()=>[o(W,null,{default:r(()=>[o(S,{onClick:ue,loading:s.value},{default:r(()=>p[2]||(p[2]=[k("下載")])),_:1},8,["loading"]),o(S,{onClick:K,loading:c.value},{default:r(()=>p[3]||(p[3]=[k("生成連結")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ve,{modelValue:d.value,"onUpdate:modelValue":p[1]||(p[1]=x=>d.value=x),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",vt,$(u.value),1)]),_:1},8,["modelValue"])],64))}}),gt={style:{position:"relative"},class:"size"},ht=["src","alt"],bt={style:{position:"relative"}},xt={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},kt="https://mypic.0m0.uk/images/",It=U({__name:"CardComponent",props:{styles:{type:Object,required:!0},cardData:{type:Object,required:!0}},setup(m){const l=De(),a=y(null),e=m,t=e.cardData.text,n=e.cardData.season,d=e.cardData.episode,u=e.cardData.frameStart,f=e.cardData.framePrefer,s=n==2?"Ave Mujica":"MyGO",c=`${s} 第${d}話`,i=`${d}`,V=oe.videoLink[s][i],C=[0,0,34288,68333,0,0,0,0,0,0,0,0,0,0],se=Math.round((e.cardData.frameStart+(n==1?C[d]:0))/23.976),ue=`${V}&t=${se}s`,Z=u/23.976,K=`${Math.floor(Z/60)}:${("0"+Math.floor(Z%60)).slice(-2)}`,E=j(()=>`${kt}${n}/${d}/${f}.webp`),L=y(!1),g=y(!1),p=y("連結複製成功"),x=y(!1),D=y(!1);async function ge(){if(!x.value){x.value=!0,p.value="下載中...",g.value=!0;try{const h=await he(),F=await(await fetch(h)).blob(),T=URL.createObjectURL(F),O=document.createElement("a");O.href=T,O.download=`${t}.png`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(T),p.value="下載完成"}catch(h){de(h),p.value="下載失敗"}finally{x.value=!1,g.value=!0}}}var X=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);let A=!1;const ee=async h=>{if(A&&!h){A=!1;return}if(h&&(A=!0,X)){p.value="因瀏覽器限制，不支援長按複製連結",g.value=!0;return}if(D.value)return;D.value=!0,g.value=!1;const v=h||l.copyMode;try{v?await te():await $e()}catch(F){if(de(F),X)p.value="複製失敗，請稍後重試，或切換為複製連結";else try{await te(),p.value="複製圖片失敗，已複製連結"}catch(T){console.error("Error during copy:",T.message),p.value="失敗 請按左下角回報手機型號/瀏覽器",de(T)}}finally{D.value=!1,g.value=!0}},te=async()=>{await navigator.clipboard.writeText(E.value),p.value="連結複製成功"},$e=async()=>{const h=new ClipboardItem({"image/png":(async()=>{const v=await he();return await(await fetch(v)).blob()})()});await navigator.clipboard.write([h]),p.value="圖片複製成功"},Te=(()=>{const h=document.createElement("canvas"),v=h.getContext("2d",{alpha:!1,willReadFrequently:!0})??new CanvasRenderingContext2D;return{canvas:h,ctx:v}})();var ae="";async function he(){if(ae)return ae;let h=new Image;h.src=E.value,h.crossOrigin="Anonymous",h.style.display="none",await new Promise(T=>{h.onload=T});const{canvas:v,ctx:F}=Te;return v.width=h.width,v.height=h.height,F.drawImage(h,0,0),ae=v.toDataURL("image/png"),ae}async function de(h){const v={content:`Copy failed: ${h.name}

${navigator.userAgent}

${h.message}

${h.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})}catch(F){console.error("Failed to send error report to Discord:",F)}}return(h,v)=>{const F=_e,T=Ue("long-press");return I(),H("div",{style:Oe(m.styles)},[o(B,{class:"card size",color:"surface-variant",rounded:"lg",variant:"tonal",onClick:v[0]||(v[0]=O=>L.value=!0)},{default:r(()=>[b("div",gt,[b("img",{src:E.value,class:"size",alt:w(t)},null,8,ht),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},$(c)+" "+$(K))]),o(fe,{class:"card-text text-center justify-center"},{default:r(()=>[k($(w(t)),1)]),_:1})]),_:1}),o(J,{modelValue:L.value,"onUpdate:modelValue":v[3]||(v[3]=O=>L.value=O),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(B,null,{default:r(()=>[b("div",bt,[o(Ce,{src:E.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},$(c)+" "+$(K))]),o(W,null,{default:r(()=>[o(z,null,{default:r(()=>[o(fe,{class:"text-center"},{default:r(()=>[k($(w(t)),1)]),_:1})]),_:1})]),_:1}),o(re,null,{default:r(()=>[o(W,null,{default:r(()=>[o(S,null,{default:r(()=>[v[5]||(v[5]=k(" 回報 ")),o(F,{fileName:E.value,text:w(t)},null,8,["fileName","text"])]),_:1}),o(S,{onClick:ge,loading:x.value},{default:r(()=>v[6]||(v[6]=[k("下載")])),_:1},8,["loading"]),o(S,{onClick:v[1]||(v[1]=()=>{var O;return(O=a.value)==null?void 0:O.CreateGif()})},{default:r(()=>v[7]||(v[7]=[k("GIF")])),_:1}),Me((I(),P(S,{onClick:v[2]||(v[2]=()=>ee(!1)),loading:D.value},{default:r(()=>v[8]||(v[8]=[k("複製")])),_:1},8,["loading"])),[[T,()=>ee(!0)]]),o(S,{href:ue,target:"_blank"},{default:r(()=>v[9]||(v[9]=[k(" 從這裡開始看 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(wt,{ref_key:"gifDialogRef",ref:a,text:w(t),season:w(n),episode:w(d),"frame-start":w(u),"frame-end":e.cardData.frameEnd},null,8,["text","season","episode","frame-start","frame-end"]),o(ve,{modelValue:g.value,"onUpdate:modelValue":v[4]||(v[4]=O=>g.value=O),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",xt,$(p.value),1)]),_:1},8,["modelValue"])],4)}}}),Fe=(m,l)=>{const a=m.__vccOpts||m;for(const[e,t]of l)a[e]=t;return a},Vt=Fe(It,[["__scopeId","data-v-40fbedcd"]]),St=U({__name:"ResultGrid",setup(m){const l=ye(),a=ft();a.fetchData();const{filteredCards:e}=et(a);let t=y(4);const n=()=>{t.value=(1+Math.floor((window.innerWidth-320)/310))*8},d=j(()=>{typeof window<"u"&&window.scrollTo({top:0,left:0,behavior:"smooth"});const f=e.value;return l.reverse,(s,c)=>{const i=f.slice(s*c,(s+1)*c);return Promise.resolve(i)}}),u=f=>{var s;return(s=f.value)==null?void 0:s.segmentId};return le(()=>{n(),window.addEventListener("resize",n)}),Re(()=>{window.removeEventListener("resize",n)}),(f,s)=>(I(),P(Ee,null,{default:r(()=>[o(w(rt),{length:w(e).length?w(e).length:1,pageSize:w(t),pageProvider:d.value,"get-key":u,"page-provider-debounce-time":100,class:"grid ma-5"},{placeholder:r(({index:c,style:i})=>[b("div",{class:"item",style:Oe(i)},$(w(e).length?"還在GO...":""),5)]),default:r(({item:c,style:i,index:V})=>[o(Vt,{styles:i,cardData:c},null,8,["styles","cardData"])]),_:1},8,["length","pageSize","pageProvider"])]),fallback:r(()=>s[0]||(s[0]=[b("p",null,"Loading...",-1)])),_:1}))}}),Ot=Fe(St,[["__scopeId","data-v-e1182e96"]]),Se=U({__name:"MultiSelect",props:Le({items:{type:Array,required:!0},label:{type:String,required:!1,default:"Select"}},{modelValue:{type:Array,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const l=m,a=je(m,"modelValue"),e=j(()=>a.value.length===l.items.length),t=j(()=>a.value.length>0&&a.value.length<l.items.length),n=()=>{e.value?a.value=[]:a.value=[...l.items]};return Y(a,()=>{a.value.sort()}),(d,u)=>(I(),P(He,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f),label:m.label,variant:"outlined",multiple:"",items:m.items,style:{"min-width":"250px"}},{"prepend-item":r(()=>[o(q,{title:"全選",onClick:n},{prepend:r(()=>[o(Ye,{indeterminate:t.value,"model-value":e.value},null,8,["indeterminate","model-value"])]),_:1}),o(We,{class:"mt-2"})]),selection:r(({item:f,index:s})=>[a.value.length!=m.items.length?(I(),P(xe,{key:0},{default:r(()=>[b("span",null,$(f.value),1)]),_:2},1024)):ce("",!0),s===m.items.length-1?(I(),P(xe,{key:1},{default:r(()=>u[1]||(u[1]=[b("span",null,"全選",-1)])),_:1})):ce("",!0)]),_:1},8,["modelValue","label","items"]))}}),Pt=U({__name:"FilterDialog",setup(m){const l=we(),a=y(!1),e=y([]),t=y([]),n=y([]),d=()=>{t.value=[],n.value=[],e.value=[]},u=()=>{l.mygoFilter=t.value,l.avemujicaFilter=n.value,l.characterFilter=0,a.value=!1};return le(()=>{const s=new URLSearchParams(window.location.search).get("ep");if(s){for(var c=+s,i=0;c&&i<13;i++){const V=c&1;c=c>>1,V&&t.value.push(i+1)}for(var i=0;c&&i<13;i++){const C=c&1;c=c>>1,C&&n.value.push(i+1)}u()}}),(f,s)=>(I(),P(J,{modelValue:a.value,"onUpdate:modelValue":s[2]||(s[2]=c=>a.value=c),"max-width":"600px",style:{"min-height":"600px"},transition:"dialog-top-transition"},{activator:r(({props:c})=>[o(ne,Ge(c,{icon:w(Ze)}),null,16,["icon"])]),default:r(()=>[o(B,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[s[3]||(s[3]=b("br",null,null,-1)),s[4]||(s[4]=b("br",null,null,-1)),s[5]||(s[5]=b("span",{class:"align-center"},"集數篩選",-1)),o(Se,{items:Array.from({length:13},(c,i)=>i+1),modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=c=>t.value=c),label:"MyGO",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(Se,{items:Array.from({length:12},(c,i)=>i+1),modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=c=>n.value=c),label:"Ave Mujica",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(re,null,{default:r(()=>[o(S,{class:"text-center",text:"清除篩選",onClick:d}),o(S,{class:"text-center",text:"確定",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ct=U({__name:"AppBarComponent",setup(m){const l=ye(),a=we(),e=y(),t=y(""),n=()=>{clearTimeout(e.value),e.value=setTimeout(d,500)},d=()=>{clearTimeout(e.value),a.query=t.value},u=()=>{t.value="",a.query=""};return le(()=>{const s=new URLSearchParams(window.location.search).get("q");s&&(t.value=s,a.query=s)}),(f,s)=>{const c=Pt;return I(),P(Je,{density:"prominent"},{default:r(()=>[o(Pe,null,{default:r(()=>[s[2]||(s[2]=b("div",{class:"text-h5 mx-auto font-weight-bold text-center text-truncate"}," MyGO Mujica 截圖搜尋器 ",-1)),o(W,{dense:"",class:"mt-2"},{default:r(()=>[o(z,{class:"text-center"},{default:r(()=>[o(pe,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value=i),"single-line":"","hide-details":"",clearable:"",label:"搜尋",variant:"outlined",class:"short-search",onKeyup:Ae(d,["enter"]),"onClick:clear":u,onInput:n,autofocus:""},{append:r(()=>[o(ne,{onClick:s[0]||(s[0]=i=>w(l).reverse=!w(l).reverse),icon:w(l).reverse?w(Ke):w(Xe)},null,8,["icon"])]),"append-inner":r(()=>[o(c)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),Lt=U({__name:"index",setup(m){return(l,a)=>{const e=Ct,t=Ot,n=mt;return I(),H(me,null,[o(e),o(t),o(n,{style:{width:"100%"}})],64)}}});export{Lt as default};
