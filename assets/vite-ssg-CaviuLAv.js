import{c as C}from"./@unhead-DQR5zzVu.js";import{k as h,r as I,l as g,p as O}from"./@vue-WVfTJAwV.js";import{c as T,a as b}from"./vue-router-DxF8NQ87.js";function v(t){return document.readyState==="loading"?new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e(t))}):Promise.resolve(t)}const E=h({setup(t,{slots:e}){const r=I(!1);return g(()=>r.value=!0),()=>r.value?e.default&&e.default({}):e.placeholder&&e.placeholder({})}});function L(t){try{return JSON.parse(t||"{}")}catch(e){return console.error("[SSG] On state deserialization -",e,t),{}}}function M(t,e,r,P){const{transformState:o,registerComponents:m=!0,useHead:f=!0,rootContainer:R="#app"}={};async function p(d=!1,s){const i=O(t);let l;f&&i.use(l=C());const c=T({history:b(e.base),...e}),{routes:y}=e;m&&i.component("ClientOnly",E);const A=[],n={app:i,head:l,isClient:!0,router:c,routes:y,onSSRAppRendered:()=>{},triggerOnSSRAppRendered:()=>Promise.all(A.map(a=>a())),initialState:{},transformState:o,routePath:s};await v(),n.initialState=(o==null?void 0:o(window.__INITIAL_STATE__||{}))||L(window.__INITIAL_STATE__),await(r==null?void 0:r(n)),i.use(c);let u,S=!0;c.beforeEach((a,k,w)=>{(S||u&&u===a.path)&&(S=!1,u=a.path,a.meta.state=n.initialState),w()});const _=n.initialState;return{...n,initialState:_}}return(async()=>{const{app:d,router:s}=await p();await s.isReady(),d.mount(R,!0)})(),p}export{M as V};
