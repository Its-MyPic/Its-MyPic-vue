import{c as x}from"./hookable-B8xFkYCm.js";const U=new Set(["link","style","script","noscript"]),W=new Set(["title","titleTemplate","script","style","noscript"]),A=new Set(["base","meta","link","style","script","noscript"]),$=new Set(["title","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),D=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),z=new Set(["key","tagPosition","tagPriority","tagDuplicateStrategy","innerHTML","textContent","processTemplateParams"]),q=new Set(["templateParams","htmlAttrs","bodyAttrs"]),I=new Set(["theme-color","google-site-verification","og","article","book","profile","twitter","author"]),F=["name","property","http-equiv"],K=new Set(["viewport","description","keywords","robots"]);function O(t){const e=t.split(":");return e.length?I.has(e[1]):!1}function S(t){const{props:e,tag:n}=t;if(D.has(n))return n;if(n==="link"&&e.rel==="canonical")return"canonical";if(e.charset)return"charset";if(t.tag==="meta"){for(const r of F)if(e[r]!==void 0){const c=e[r],l=c.includes(":"),i=K.has(c),f=!(l||i)&&t.key?`:key:${t.key}`:"";return`${n}:${c}${f}`}}if(t.key)return`${n}:key:${t.key}`;if(e.id)return`${n}:id:${e.id}`;if(W.has(n)){const r=t.textContent||t.innerHTML;if(r)return`${n}:content:${r}`}}function C(t){const e=t._h||t._d;if(e)return e;const n=t.textContent||t.innerHTML;return n||`${t.tag}:${Object.entries(t.props).map(([r,c])=>`${r}:${String(c)}`).join(",")}`}function H(t,e,n){typeof t==="function"&&(!n||n!=="titleTemplate"&&!(n[0]==="o"&&n[1]==="n"))&&(t=t());let c;if(e&&(c=e(n,t)),Array.isArray(c))return c.map(l=>H(l,e));if((c==null?void 0:c.constructor)===Object){const l={};for(const i of Object.keys(c))l[i]=H(c[i],e,i);return l}return c}function V(t,e){const n=t==="style"?new Map:new Set;function r(c){const l=c.trim();if(l)if(t==="style"){const[i,...d]=l.split(":").map(f=>f.trim());i&&d.length&&n.set(i,d.join(":"))}else l.split(" ").filter(Boolean).forEach(i=>n.add(i))}return typeof e=="string"?t==="style"?e.split(";").forEach(r):r(e):Array.isArray(e)?e.forEach(c=>r(c)):e&&typeof e=="object"&&Object.entries(e).forEach(([c,l])=>{l&&l!=="false"&&(t==="style"?n.set(c.trim(),l):r(c))}),n}function R(t,e){return t.props=t.props||{},e?t.tag==="templateParams"?(t.props=e,t):(Object.entries(e).forEach(([n,r])=>{if(r===null){t.props[n]=null;return}if(n==="class"||n==="style"){t.props[n]=V(n,r);return}if(z.has(n)){if(["textContent","innerHTML"].includes(n)&&typeof r=="object"){let i=e.type;if(e.type||(i="application/json"),!(i!=null&&i.endsWith("json"))&&i!=="speculationrules")return;e.type=i,t.props.type=i,t[n]=JSON.stringify(r)}else t[n]=r;return}const c=String(r),l=n.startsWith("data-");c==="true"||c===""?t.props[n]=l?c:!0:!r&&l&&c==="false"?t.props[n]="false":r!==void 0&&(t.props[n]=r)}),t):t}function G(t,e){const n=typeof e=="object"&&typeof e!="function"?e:{[t==="script"||t==="noscript"||t==="style"?"innerHTML":"textContent"]:e},r=R({tag:t,props:{}},n);return r.key&&U.has(r.tag)&&(r.props["data-hid"]=r._h=r.key),r.tag==="script"&&typeof r.innerHTML=="object"&&(r.innerHTML=JSON.stringify(r.innerHTML),r.props.type=r.props.type||"application/json"),Array.isArray(r.props.content)?r.props.content.map(c=>({...r,props:{...r.props,content:c}})):r}function J(t,e){if(!t)return[];typeof t=="function"&&(t=t());const n=(c,l)=>{for(let i=0;i<e.length;i++)l=e[i](c,l);return l};t=n(void 0,t);const r=[];return t=H(t,n),Object.entries(t||{}).forEach(([c,l])=>{if(l!==void 0)for(const i of Array.isArray(l)?l:[l])r.push(G(c,i))}),r.flat()}const E=(t,e)=>t._w===e._w?t._p-e._p:t._w-e._w,P={base:-10,title:10},B={critical:-8,high:-1,low:2},L={meta:{"content-security-policy":-30,charset:-20,viewport:-15},link:{preconnect:20,stylesheet:60,preload:70,modulepreload:70,prefetch:90,"dns-prefetch":90,prerender:90},script:{async:30,defer:80,sync:50},style:{imported:40,sync:60}},N=/@import/,M=t=>t===""||t===!0;function Q(t,e){var l;if(typeof e.tagPriority=="number")return e.tagPriority;let n=100;const r=B[e.tagPriority]||0,c=t.resolvedOptions.disableCapoSorting?{link:{},script:{},style:{}}:L;if(e.tag in P)n=P[e.tag];else if(e.tag==="meta"){const i=e.props["http-equiv"]==="content-security-policy"?"content-security-policy":e.props.charset?"charset":e.props.name==="viewport"?"viewport":null;i&&(n=L.meta[i])}else e.tag==="link"&&e.props.rel?n=c.link[e.props.rel]:e.tag==="script"?M(e.props.async)?n=c.script.async:e.props.src&&!M(e.props.defer)&&!M(e.props.async)&&e.props.type!=="module"&&!((l=e.props.type)!=null&&l.endsWith("json"))?n=c.script.sync:M(e.props.defer)&&e.props.src&&!M(e.props.async)&&(n=c.script.defer):e.tag==="style"&&(n=e.innerHTML&&N.test(e.innerHTML)?c.style.imported:c.style.sync);return(n||100)+r}function j(t,e){const n=typeof e=="function"?e(t):e,r=n.key||String(t.plugins.size+1);t.plugins.get(r)||(t.plugins.set(r,n),t.hooks.addHooks(n.hooks||{}))}function X(t={}){var d;const e=x();e.addHooks(t.hooks||{});const n=!t.document,r=new Map,c=new Map,l=new Set,i={_entryCount:1,plugins:c,dirty:!1,resolvedOptions:t,hooks:e,ssr:n,entries:r,headEntries(){return[...r.values()]},use:f=>j(i,f),push(f,g){const y={...g||{}};delete y.head;const m=y._index??i._entryCount++,w={_i:m,input:f,options:y},T={_poll(o=!1){i.dirty=!0,!o&&l.add(m),e.callHook("entries:updated",i)},dispose(){r.delete(m)&&i.invalidate()},patch(o){(!y.mode||y.mode==="server"&&n||y.mode==="client"&&!n)&&(w.input=o,r.set(m,w),T._poll())}};return T.patch(f),T},async resolveTags(){var T;const f={tagMap:new Map,tags:[],entries:[...i.entries.values()]};for(await e.callHook("entries:resolve",f);l.size;){const o=l.values().next().value;l.delete(o);const s=r.get(o);if(s){const a={tags:J(s.input,t.propResolvers||[]).map(p=>Object.assign(p,s.options)),entry:s};await e.callHook("entries:normalize",a),s._tags=a.tags.map((p,u)=>(p._w=Q(i,p),p._p=(s._i<<10)+u,p._d=S(p),p))}}let g=!1;f.entries.flatMap(o=>(o._tags||[]).map(s=>({...s,props:{...s.props}}))).sort(E).reduce((o,s)=>{const a=String(s._d||s._p);if(!o.has(a))return o.set(a,s);const p=o.get(a);if(((s==null?void 0:s.tagDuplicateStrategy)||(q.has(s.tag)?"merge":null)||(s.key&&s.key===p.key?"merge":null))==="merge"){const h={...p.props};Object.entries(s.props).forEach(([_,b])=>h[_]=_==="style"?new Map([...p.props.style||new Map,...b]):_==="class"?new Set([...p.props.class||new Set,...b]):b),o.set(a,{...s,props:h})}else s._p>>10===p._p>>10&&s.tag==="meta"&&O(a)?(o.set(a,Object.assign([...Array.isArray(p)?p:[p],s],s)),g=!0):(s._w===p._w?s._p>p._p:(s==null?void 0:s._w)<(p==null?void 0:p._w))&&o.set(a,s);return o},f.tagMap);const y=f.tagMap.get("title"),m=f.tagMap.get("titleTemplate");if(i._title=y==null?void 0:y.textContent,m){const o=m==null?void 0:m.textContent;if(i._titleTemplate=o,o){let s=typeof o=="function"?o(y==null?void 0:y.textContent):o;typeof s=="string"&&!i.plugins.has("template-params")&&(s=s.replace("%s",(y==null?void 0:y.textContent)||"")),y?s===null?f.tagMap.delete("title"):f.tagMap.set("title",{...y,textContent:s}):(m.tag="title",m.textContent=s)}}f.tags=Array.from(f.tagMap.values()),g&&(f.tags=f.tags.flat().sort(E)),await e.callHook("tags:beforeResolve",f),await e.callHook("tags:resolve",f),await e.callHook("tags:afterResolve",f);const w=[];for(const o of f.tags){const{innerHTML:s,tag:a,props:p}=o;if($.has(a)&&!(Object.keys(p).length===0&&!o.innerHTML&&!o.textContent)&&!(a==="meta"&&!p.content&&!p["http-equiv"]&&!p.charset)){if(a==="script"&&s){if((T=p.type)!=null&&T.endsWith("json")){const u=typeof s=="string"?s:JSON.stringify(s);o.innerHTML=u.replace(/</g,"\\u003C")}else typeof s=="string"&&(o.innerHTML=s.replace(new RegExp(`</${a}`,"g"),`<\\/${a}`));o._d=S(o)}w.push(o)}}return w},invalidate(){for(const f of r.values())l.add(f._i);i.dirty=!0,e.callHook("entries:updated",i)}};return((t==null?void 0:t.plugins)||[]).forEach(f=>j(i,f)),i.hooks.callHook("init",i),(d=t.init)==null||d.forEach(f=>f&&i.push(f)),i}async function Y(t,e={}){const n=e.document||t.resolvedOptions.document;if(!n||!t.dirty)return;const r={shouldRender:!0,tags:[]};if(await t.hooks.callHook("dom:beforeRender",r),!!r.shouldRender)return t._domUpdatePromise||(t._domUpdatePromise=new Promise(async c=>{var T;const l=new Map,i=new Promise(o=>{t.resolveTags().then(s=>{o(s.map(a=>{const p=l.get(a._d)||0,u={tag:a,id:(p?`${a._d}:${p}`:a._d)||C(a),shouldRender:!0};return a._d&&O(a._d)&&l.set(a._d,p+1),u}))})});let d=t._dom;if(!d){d={title:n.title,elMap:new Map().set("htmlAttrs",n.documentElement).set("bodyAttrs",n.body)};for(const o of["body","head"]){const s=(T=n[o])==null?void 0:T.children;for(const a of s){const p=a.tagName.toLowerCase();if(!A.has(p))continue;const u=R({tag:p,props:{}},{innerHTML:a.innerHTML,...a.getAttributeNames().reduce((h,_)=>(h[_]=a.getAttribute(_),h),{})||{}});if(u.key=a.getAttribute("data-hid")||void 0,u._d=S(u)||C(u),d.elMap.has(u._d)){let h=1,_=u._d;for(;d.elMap.has(_);)_=`${u._d}:${h++}`;d.elMap.set(_,a)}else d.elMap.set(u._d,a)}}}d.pendingSideEffects={...d.sideEffects},d.sideEffects={};function f(o,s,a){const p=`${o}:${s}`;d.sideEffects[p]=a,delete d.pendingSideEffects[p]}function g({id:o,$el:s,tag:a}){const p=a.tag.endsWith("Attrs");d.elMap.set(o,s),p||(a.textContent&&a.textContent!==s.textContent&&(s.textContent=a.textContent),a.innerHTML&&a.innerHTML!==s.innerHTML&&(s.innerHTML=a.innerHTML),f(o,"el",()=>{s==null||s.remove(),d.elMap.delete(o)}));for(const u in a.props){if(!Object.prototype.hasOwnProperty.call(a.props,u))continue;const h=a.props[u];if(u.startsWith("on")&&typeof h=="function"){const b=s==null?void 0:s.dataset;if(b&&b[`${u}fired`]){const k=u.slice(0,-5);h.call(s,new Event(k.substring(2)))}s.getAttribute(`data-${u}`)!==""&&((a.tag==="bodyAttrs"?n.defaultView:s).addEventListener(u.substring(2),h.bind(s)),s.setAttribute(`data-${u}`,""));continue}const _=`attr:${u}`;if(u==="class"){if(!h)continue;for(const b of h)p&&f(o,`${_}:${b}`,()=>s.classList.remove(b)),!s.classList.contains(b)&&s.classList.add(b)}else if(u==="style"){if(!h)continue;for(const[b,k]of h)f(o,`${_}:${b}`,()=>{s.style.removeProperty(b)}),s.style.setProperty(b,k)}else h!==!1&&h!==null&&(s.getAttribute(u)!==h&&s.setAttribute(u,h===!0?"":String(h)),p&&f(o,_,()=>s.removeAttribute(u)))}}const y=[],m={bodyClose:void 0,bodyOpen:void 0,head:void 0},w=await i;for(const o of w){const{tag:s,shouldRender:a,id:p}=o;if(a){if(s.tag==="title"){n.title=s.textContent,f("title","",()=>n.title=d.title);continue}o.$el=o.$el||d.elMap.get(p),o.$el?g(o):A.has(s.tag)&&y.push(o)}}for(const o of y){const s=o.tag.tagPosition||"head";o.$el=n.createElement(o.tag.tag),g(o),m[s]=m[s]||n.createDocumentFragment(),m[s].appendChild(o.$el)}for(const o of w)await t.hooks.callHook("dom:renderTag",o,n,f);m.head&&n.head.appendChild(m.head),m.bodyOpen&&n.body.insertBefore(m.bodyOpen,n.body.firstChild),m.bodyClose&&n.body.appendChild(m.bodyClose);for(const o in d.pendingSideEffects)d.pendingSideEffects[o]();t._dom=d,await t.hooks.callHook("dom:rendered",{renders:w}),c()}).finally(()=>{t._domUpdatePromise=void 0,t.dirty=!1})),t._domUpdatePromise}function nt(t={}){var r,c,l;const e=((r=t.domOptions)==null?void 0:r.render)||Y;t.document=t.document||(typeof window<"u"?document:void 0);const n=((l=(c=t.document)==null?void 0:c.head.querySelector('script[id="unhead:payload"]'))==null?void 0:l.innerHTML)||!1;return X({...t,plugins:[...t.plugins||[],{key:"client",hooks:{"entries:updated":e}}],init:[n?JSON.parse(n):!1,...t.init||[]]})}function st(t,e){let n=0;return()=>{const r=++n;e(()=>{n===r&&t()})}}const Z="modulepreload",tt=function(t){return"/"+t},v={},rt=function(e,n,r){let c=Promise.resolve();if(n&&n.length>0){let i=function(g){return Promise.all(g.map(y=>Promise.resolve(y).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));c=i(n.map(g=>{if(g=tt(g),g in v)return;v[g]=!0;const y=g.endsWith(".css"),m=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${m}`))return;const w=document.createElement("link");if(w.rel=y?"stylesheet":Z,y||(w.as="script"),w.crossOrigin="",w.href=g,f&&w.setAttribute("nonce",f),document.head.appendChild(w),y)return new Promise((T,o)=>{w.addEventListener("load",T),w.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return c.then(i=>{for(const d of i||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};export{rt as _,st as a,nt as c,Y as r};
