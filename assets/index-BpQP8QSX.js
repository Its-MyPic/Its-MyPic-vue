import{k as U,r as y,D as I,I as J,X as o,F as r,a5 as k,a7 as b,J as ve,w as W,c as j,l as le,E as O,u as w,a8 as fe,$,a2 as Me,B as Re,L as Pe,O as Ee,a9 as Le,aa as je,ab as Ge,Y as Ae,ac as Ne}from"./@vue-CNCR8Vmv.js";import{e as z,f as qe,g as pe,h as me,i as re,j as S,k as Z,l as ye,u as ze,n as Be,o as H,p as q,q as Qe,r as Ye,s as ne,t as N,v as Y,w as xe,x as Ce,y as _e,z as We,A as He,B as ke,C as Je,D as Ze}from"./vuetify-BEJceuSt.js";import{m as A,a as Ie,b as Ke,c as Xe,d as et}from"./@mdi-DKC2W5MC.js";import{d as ie,s as tt}from"./pinia-CqnXpMGa.js";import{m as G}from"./protobufjs-CgPuVhCO.js";import{f as at,F as nt}from"./@ffmpeg-B1ncfXmI.js";import{C as ot,t as lt,c as rt}from"./opencc-js-D-mJJ3do.js";import{G as it}from"./vue-virtual-scroll-grid-DXBkyr0D.js";import"./@protobufjs-f4nnaicZ.js";const st="MTMzNTEwMzQ1NzY4MTczNTc2MC9LT0lwZ2FDc3RmRURnVHVqR2dEYmVYWWZSLUdZRjVQQ29veXZ0TFVGbFhFM0tYdGRGTzhHR3RrTXptWEp4R3FxQVI5bw==",ut={MyGO:{1:"https://www.youtube.com/watch?v=WOrYBIYIwyk",2:"https://www.youtube.com/watch?v=WOrYBIYIwyk",3:"https://www.youtube.com/watch?v=WOrYBIYIwyk",4:"https://www.youtube.com/watch?v=ijdspfPMzYc",5:"https://www.youtube.com/watch?v=zfA0zRAkAdk",6:"https://www.youtube.com/watch?v=UwgyEoB9vU8",7:"https://www.youtube.com/watch?v=rlY2b3TIYPs",8:"https://www.youtube.com/watch?v=mfboDpl88QY",9:"https://www.youtube.com/watch?v=ySjYENzyZmY",10:"https://www.youtube.com/watch?v=bLWDIYpGcEI",11:"https://www.youtube.com/watch?v=gAFDVnhX24o",12:"https://www.youtube.com/watch?v=wei3payuSi8",13:"https://www.youtube.com/watch?v=uQ3_PvPCNnI"},"Ave Mujica":{1:"https://www.youtube.com/watch?v=dxmmSFQxWzM",2:"https://www.youtube.com/watch?v=Bzl61esi4qc",3:"https://www.youtube.com/watch?v=HagaJboujK4",4:"https://www.youtube.com/watch?v=Z6cOxtDsfNU",5:"https://www.youtube.com/watch?v=7D2uGv7aprQ",6:"https://www.youtube.com/watch?v=jQraN1emvLQ",7:"https://www.youtube.com/watch?v=RONGNWb7OpQ",8:"https://www.youtube.com/watch?v=uh9jUhVTS28",9:"https://www.youtube.com/watch?v=pGrI6hk0vBg",10:"https://www.youtube.com/watch?v=m9cjOcCKIyQ",11:"https://www.youtube.com/watch?v=Cfm8TWGkvYQ",12:"https://www.youtube.com/watch?v=UtSEFdDZZLw"}},oe={webhook:st,videoLink:ut},De=U({__name:"ReportDialog",props:{fileName:{type:String,required:!1,default:""},text:{type:String,required:!1,default:""}},setup(m){const l=m,a=y(""),e=y(""),t=y(!1),n=y(!1);async function d(){let u="";if(a.value&&(u+=`問題: ${a.value}
`),e.value&&(u+=`聯絡方式: ${e.value}
`),l.fileName&&(u+=`檔案名稱: ${l.fileName}
`),l.text&&(u+=`文字: ${l.text}
`),u){const f={content:u};await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),t.value=!0}n.value=!1}return(u,f)=>(I(),J(ve,null,[o(Z,{modelValue:n.value,"onUpdate:modelValue":f[2]||(f[2]=s=>n.value=s),activator:"parent","max-width":"600px",style:{maxHeight:"90vh"},transition:"dialog-bottom-transition"},{default:r(()=>[o(z,null,{default:r(()=>[o(qe,null,{default:r(()=>f[4]||(f[4]=[k("回報問題")])),_:1}),o(pe,null,{default:r(()=>[o(me,{label:"你遭遇到的問題(選填)",modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=s=>a.value=s),outlined:""},null,8,["modelValue"]),o(me,{label:"你的聯絡方式(選填)",modelValue:e.value,"onUpdate:modelValue":f[1]||(f[1]=s=>e.value=s),outlined:""},null,8,["modelValue"])]),_:1}),o(re,null,{default:r(()=>[o(S,{onClick:d},{default:r(()=>f[5]||(f[5]=[k("送出")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ye,{modelValue:t.value,"onUpdate:modelValue":f[3]||(f[3]=s=>t.value=s),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>f[6]||(f[6]=[b("div",{class:"text-h6 mx-auto font-weight-bold text-center text-truncate"}," 已回報問題 ",-1)])),_:1},8,["modelValue"])],64))}}),M=G.Reader,Ve=G.Writer,R=G.util,C=G.roots.default||(G.roots.default={}),dt=C.data=(()=>{const m={};return m.Info=function(){function l(a){if(a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.text="",l.prototype.season=0,l.prototype.episode=0,l.prototype.frameStart=0,l.prototype.framePrefer=0,l.prototype.frameEnd=0,l.prototype.segmentId=0,l.create=function(e){return new l(e)},l.encode=function(e,t){return t||(t=Ve.create()),e.text!=null&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),e.season!=null&&Object.hasOwnProperty.call(e,"season")&&t.uint32(16).int32(e.season),e.episode!=null&&Object.hasOwnProperty.call(e,"episode")&&t.uint32(24).int32(e.episode),e.frameStart!=null&&Object.hasOwnProperty.call(e,"frameStart")&&t.uint32(32).int32(e.frameStart),e.framePrefer!=null&&Object.hasOwnProperty.call(e,"framePrefer")&&t.uint32(40).int32(e.framePrefer),e.frameEnd!=null&&Object.hasOwnProperty.call(e,"frameEnd")&&t.uint32(48).int32(e.frameEnd),e.segmentId!=null&&Object.hasOwnProperty.call(e,"segmentId")&&t.uint32(56).int32(e.segmentId),t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof M||(e=M.create(e));let n=t===void 0?e.len:e.pos+t,d=new C.data.Info;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.text=e.string();break}case 2:{d.season=e.int32();break}case 3:{d.episode=e.int32();break}case 4:{d.frameStart=e.int32();break}case 5:{d.framePrefer=e.int32();break}case 6:{d.frameEnd=e.int32();break}case 7:{d.segmentId=e.int32();break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof M||(e=new M(e)),this.decode(e,e.uint32())},l.verify=function(e){return typeof e!="object"||e===null?"object expected":e.text!=null&&e.hasOwnProperty("text")&&!R.isString(e.text)?"text: string expected":e.season!=null&&e.hasOwnProperty("season")&&!R.isInteger(e.season)?"season: integer expected":e.episode!=null&&e.hasOwnProperty("episode")&&!R.isInteger(e.episode)?"episode: integer expected":e.frameStart!=null&&e.hasOwnProperty("frameStart")&&!R.isInteger(e.frameStart)?"frameStart: integer expected":e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&!R.isInteger(e.framePrefer)?"framePrefer: integer expected":e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&!R.isInteger(e.frameEnd)?"frameEnd: integer expected":e.segmentId!=null&&e.hasOwnProperty("segmentId")&&!R.isInteger(e.segmentId)?"segmentId: integer expected":null},l.fromObject=function(e){if(e instanceof C.data.Info)return e;let t=new C.data.Info;return e.text!=null&&(t.text=String(e.text)),e.season!=null&&(t.season=e.season|0),e.episode!=null&&(t.episode=e.episode|0),e.frameStart!=null&&(t.frameStart=e.frameStart|0),e.framePrefer!=null&&(t.framePrefer=e.framePrefer|0),e.frameEnd!=null&&(t.frameEnd=e.frameEnd|0),e.segmentId!=null&&(t.segmentId=e.segmentId|0),t},l.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.text="",n.season=0,n.episode=0,n.frameStart=0,n.framePrefer=0,n.frameEnd=0,n.segmentId=0),e.text!=null&&e.hasOwnProperty("text")&&(n.text=e.text),e.season!=null&&e.hasOwnProperty("season")&&(n.season=e.season),e.episode!=null&&e.hasOwnProperty("episode")&&(n.episode=e.episode),e.frameStart!=null&&e.hasOwnProperty("frameStart")&&(n.frameStart=e.frameStart),e.framePrefer!=null&&e.hasOwnProperty("framePrefer")&&(n.framePrefer=e.framePrefer),e.frameEnd!=null&&e.hasOwnProperty("frameEnd")&&(n.frameEnd=e.frameEnd),e.segmentId!=null&&e.hasOwnProperty("segmentId")&&(n.segmentId=e.segmentId),n},l.prototype.toJSON=function(){return this.constructor.toObject(this,G.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Info"},l}(),m.Data=function(){function l(a){if(this.info=[],a)for(let e=Object.keys(a),t=0;t<e.length;++t)a[e[t]]!=null&&(this[e[t]]=a[e[t]])}return l.prototype.info=R.emptyArray,l.create=function(e){return new l(e)},l.encode=function(e,t){if(t||(t=Ve.create()),e.info!=null&&e.info.length)for(let n=0;n<e.info.length;++n)C.data.Info.encode(e.info[n],t.uint32(10).fork()).ldelim();return t},l.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},l.decode=function(e,t){e instanceof M||(e=M.create(e));let n=t===void 0?e.len:e.pos+t,d=new C.data.Data;for(;e.pos<n;){let u=e.uint32();switch(u>>>3){case 1:{d.info&&d.info.length||(d.info=[]),d.info.push(C.data.Info.decode(e,e.uint32()));break}default:e.skipType(u&7);break}}return d},l.decodeDelimited=function(e){return e instanceof M||(e=new M(e)),this.decode(e,e.uint32())},l.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.info!=null&&e.hasOwnProperty("info")){if(!Array.isArray(e.info))return"info: array expected";for(let t=0;t<e.info.length;++t){let n=C.data.Info.verify(e.info[t]);if(n)return"info."+n}}return null},l.fromObject=function(e){if(e instanceof C.data.Data)return e;let t=new C.data.Data;if(e.info){if(!Array.isArray(e.info))throw TypeError(".data.Data.info: array expected");t.info=[];for(let n=0;n<e.info.length;++n){if(typeof e.info[n]!="object")throw TypeError(".data.Data.info: object expected");t.info[n]=C.data.Info.fromObject(e.info[n])}}return t},l.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.info=[]),e.info&&e.info.length){n.info=[];for(let d=0;d<e.info.length;++d)n.info[d]=C.data.Info.toObject(e.info[d],t)}return n},l.prototype.toJSON=function(){return this.constructor.toObject(this,G.util.toJSONOptions)},l.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/data.Data"},l}(),m})();var ct=dt.Data;const Se=m=>m.toLowerCase().replace("你","妳").replace("啊","阿"),ft=()=>ot(rt,lt),we=ie("Reverse",{state:()=>({reverse:!1})}),Fe=ie("CopyMode",{state:()=>({copyMode:!1})}),ge=ie("Query",()=>{const m=y(""),l=y([]),a=y([]),e=y(0),t=()=>{const n=new URL(window.location.href);m.value===""?n.searchParams.delete("q"):n.searchParams.set("q",m.value);for(var d=0,u=1;u<14;u++)d|=+l.value.includes(u)<<u-1;for(var u=1;u<9;u++)d|=+a.value.includes(u)<<u+12;d==0?n.searchParams.delete("ep"):n.searchParams.set("ep",d.toString()),window.history.pushState({},"",n.toString())};return W(m,t),W(l,t),W(a,t),W(e,t),{query:m,mygoFilter:l,avemujicaFilter:a,characterFilter:e}}),pt=ie("Data",()=>{const m=y([]),l=ge(),a=we();a.$subscribe(()=>{m.value.reverse()});const e=ft();var t=new Map;const n=j(()=>{if(m.value.length===0)return[];var u=m.value,f=new Set;if(l.mygoFilter.forEach(s=>{f.add(`1-${s}`)}),l.avemujicaFilter.forEach(s=>{f.add(`2-${s}`)}),f.size!==0){const s=a.reverse+Array.from(f).join("");t.has(s)?u=t.get(s)??[]:(u=m.value.filter(c=>f.has(`${c.season}-${c.episode}`)),t.set(s,u))}if(l.query==="")return u;{const s=e(Se(l.query));return u.filter(c=>Se(c.text).includes(s))}});return{cardsData:m,fetchData:async()=>{if(m.value.length===0){var u;try{var f=await(await fetch("/data/data.bin")).bytes();u=ct.decode(f).info}catch{u=[]}m.value=u,t.clear()}},filteredCards:n}}),mt={key:0,class:"ml-2 d-flex align-center"},vt=U({__name:"FooterComponent",setup(m){const l=Fe(),a=y(!0),e=j({get(){return n.global.current.value.dark},set(c){d(c)}}),t=j({get(){return l.copyMode},set(c){l.copyMode=c,localStorage.setItem("copyURLMode",c.toString())}}),n=ze();function d(c){n.global.name.value=c?"dark":"light",localStorage.setItem("darkTheme",n.global.name.value)}const u=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("firefox"),f=()=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("mobile"),s=()=>!(u()&&f());return le(()=>{a.value=s(),a.value?localStorage.getItem("copyURLMode")?l.copyMode=localStorage.getItem("copyURLMode")==="true":l.copyMode=!1:l.copyMode=!0,localStorage.getItem("darkTheme")?n.global.name.value=localStorage.getItem("darkTheme")??"dark":window.matchMedia("(prefers-color-scheme: light)").matches&&(n.global.name.value="light")}),(c,i)=>{const V=De;return I(),O(Be,{app:""},{default:r(()=>[o(Ce,{fluid:"",style:{padding:"5px"}},{default:r(()=>[o(H,null,{default:r(()=>[o(q,null,{default:r(()=>[o(S,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[7]||(i[7]=k(" 其他連結 ")),o(Qe,{activator:"parent",location:"center"},{default:r(()=>[o(Ye,null,{default:r(()=>[o(ne,{icon:`mdiSvg:${w(A)}`},null,8,["icon"]),(I(),O(N,{key:0,target:"_blank",value:0,"append-icon":w(A),href:"https://github.com/NightFeather0615/Its-MyPic-Android"},{default:r(()=>[o(Y,null,{default:r(()=>i[2]||(i[2]=[k("Its-MyPic for Android")])),_:1})]),_:1},8,["append-icon"])),(I(),O(N,{key:1,target:"_blank",value:1,"append-icon":w(A),href:"https://github.com/Its-MyPic/PowerToys-Run-Its-MyPic"},{default:r(()=>[o(Y,null,{default:r(()=>i[3]||(i[3]=[k("PowerToys-Run Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),O(N,{key:2,target:"_blank",value:2,"append-icon":w(A),href:"https://github.com/Its-MyPic/krunner-Its-MyPic"},{default:r(()=>[o(Y,null,{default:r(()=>i[4]||(i[4]=[k("Krunner Plugin")])),_:1})]),_:1},8,["append-icon"])),(I(),O(N,{key:3,target:"_blank",value:3,"append-icon":w(A),href:"https://github.com/Its-MyPic/Its-MyPic-vue"},{default:r(()=>[o(Y,null,{default:r(()=>i[5]||(i[5]=[k("這個網頁的原始碼")])),_:1})]),_:1},8,["append-icon"])),(I(),O(N,{key:4,target:"_blank",value:4,"append-icon":w(A),href:"https://github.com/Its-MyPic/Its-MyPicDB"},{default:r(()=>[o(Y,null,{default:r(()=>i[6]||(i[6]=[k("mygo系列的截圖資料")])),_:1})]),_:1},8,["append-icon"]))]),_:1})]),_:1})]),_:1}),o(S,{variant:"text",size:"small",class:"text-center"},{default:r(()=>[i[8]||(i[8]=k(" 回報問題 ")),o(V)]),_:1}),o(S,{variant:"text",size:"small",class:"text-center",href:"https://forms.gle/WzW9PZwUU6gqHZko7",target:"_blank"},{default:r(()=>i[9]||(i[9]=[k(" 投稿 ")])),_:1})]),_:1}),o(q,{cols:"1"},{default:r(()=>[o(S,{variant:"text",size:"small",density:"comfortable",icon:w(Ie)},{default:r(()=>[o(ne,{icon:w(Ie),"aria-label":"設定"},null,8,["icon"]),o(Z,{activator:"parent","max-width":"600px",style:{maxHeight:"90vh",minHeight:"200px"}},{default:r(()=>[o(z,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[i[14]||(i[14]=b("br",null,null,-1)),i[15]||(i[15]=b("span",{class:"ml-2 d-flex align-center"},"主題",-1)),o(q,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[10]||(i[10]=b("span",{class:"mr-2 d-flex align-center"},"淺色",-1)),o(xe,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=P=>e.value=P),class:"mx-2 d-flex align-center"},null,8,["modelValue"]),i[11]||(i[11]=b("span",{class:"ml-2 d-flex align-center"},"深色",-1))]),_:1}),i[16]||(i[16]=b("br",null,null,-1)),i[17]||(i[17]=b("span",{class:"ml-2 d-flex align-center"},"偏好複製模式",-1)),o(q,{cols:"auto",class:"d-flex align-center"},{default:r(()=>[i[12]||(i[12]=b("span",{class:"mr-2 d-flex align-center"},"複製圖片",-1)),o(xe,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=P=>t.value=P),class:"mx-2 d-flex align-center",disabled:!a.value},null,8,["modelValue","disabled"]),i[13]||(i[13]=b("span",{class:"ml-2 d-flex align-center"},"複製連結",-1))]),_:1}),a.value?fe("",!0):(I(),J("span",mt,"您的瀏覽器不支援複製圖片")),i[18]||(i[18]=b("br",null,null,-1))]),_:1})]),_:1})]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),yt={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},wt="https://mypic.0m0.uk/images/",gt=U({__name:"GifDialog",props:{text:{},season:{},episode:{},frameStart:{},frameEnd:{}},setup(m,{expose:l}){const a=new nt;let e=!1;const t=m,n=y(!1),d=y(!1),u=y(""),f=y(!1),s=y(!1),c=y(!1),i=y(""),V=y(null),P=y(null);async function se(){e||(await a.load(),e=!0)}async function ue(){if(!V.value)return;const g=document.createElement("a");g.href=URL.createObjectURL(V.value),g.download=`${t.text}.gif`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(g.href)}async function K(){const g=new File([V.value],"download.gif",{type:"image/gif"}),p=new FormData;p.append("fileToUpload",g),p.append("reqtype","fileupload");const x=await fetch("https://cors.0m0.uk/?https://catbox.moe/user/api.php",{method:"POST",body:p});if(x.status===413)throw new Error("GIF檔案過大，請自行下載後上傳至其他圖床");return await x.text()}async function X(){if(!V.value)return;c.value=!0;const g=new ClipboardItem({"text/plain":(async()=>{try{if(P.value)return new Blob([P.value],{type:"text/plain"});u.value="正在上傳GIF...",d.value=!0;const p=await K();return P.value=p,new Blob([p],{type:"text/plain"})}catch(p){throw u.value=p instanceof Error?p.message:"GIF 上傳失敗",L(p),p}})()});try{await navigator.clipboard.write([g]),u.value="GIF 連結複製成功"}catch(p){p instanceof Error&&p.name==="NotAllowedError"?u.value="GIF 連結複製失敗":u.value=p instanceof Error?p.message:"GIF 上傳失敗",L(p)}finally{d.value=!0,c.value=!1}}async function E(){if(f.value)return;if(V.value){n.value=!0;return}P.value=null,f.value=!0,u.value="GIF生成中...",d.value=!0;const g=performance.now(),p=Array.from({length:t.frameEnd-t.frameStart-4},(x,_)=>t.frameStart+_+2);try{await se();const x=p.map(async B=>{const Q=`${wt}${t.season}/${t.episode}/${B}.webp`,te=await at(Q);await a.writeFile(`${B}.webp`,te)});await Promise.all(x),await a.exec(["-start_number",p[0].toString(),"-i","%d.webp","-vf","palettegen","palette.png"]),await a.exec(["-start_number",p[0].toString(),"-i","%d.webp","-i","palette.png","-filter_complex","paletteuse=dither=none","-frames:v",p.length.toString(),"-f","gif","-framerate","24","output.gif"]);const _=await a.readFile("output.gif");V.value=new Blob([_],{type:"image/gif"}),i.value=URL.createObjectURL(V.value);const de=((performance.now()-g)/1e3).toFixed(1);u.value=`GIF生成完成 (${de}秒)`,n.value=!0}catch(x){console.error("GIF generation failed:",x),L(x),u.value="GIF生成失敗"}finally{f.value=!1,d.value=!0;const x=p.map(_=>a.deleteFile(`${_}.webp`).catch(console.error));await Promise.all([...x,a.deleteFile("output.gif").catch(console.error),a.deleteFile("palette.png").catch(console.error)])}}async function L(g){const p={content:`Copy failed: ${g.name}

${navigator.userAgent}

${g.message}

${g.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})}catch(x){console.error("Failed to send error report to Discord:",x)}}return l({CreateGif:E}),(g,p)=>(I(),J(ve,null,[o(Z,{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=x=>n.value=x),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(z,null,{default:r(()=>[o(_e,{src:i.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),o(re,null,{default:r(()=>[o(H,null,{default:r(()=>[o(S,{onClick:ue,loading:s.value},{default:r(()=>p[2]||(p[2]=[k("下載")])),_:1},8,["loading"]),o(S,{onClick:X,loading:c.value},{default:r(()=>p[3]||(p[3]=[k("生成連結")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ye,{modelValue:d.value,"onUpdate:modelValue":p[1]||(p[1]=x=>d.value=x),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",yt,$(u.value),1)]),_:1},8,["modelValue"])],64))}}),ht={style:{position:"relative"},class:"size"},bt=["src","alt"],xt={style:{position:"relative"}},kt={class:"text-h6 mx-auto font-weight-bold text-center text-truncate"},It="https://mypic.0m0.uk/images/",Vt=U({__name:"CardComponent",props:{styles:{type:Object,required:!0},cardData:{type:Object,required:!0}},setup(m){const l=Fe(),a=y(null),e=m,t=e.cardData.text,n=e.cardData.season,d=e.cardData.episode,u=e.cardData.frameStart,f=e.cardData.framePrefer,s=n==2?"Ave Mujica":"MyGO",c=`${s} 第${d}話`,i=`${d}`,V=oe.videoLink[s][i],P=[0,0,34288,68333,0,0,0,0,0,0,0,0,0,0],se=Math.round((e.cardData.frameStart+(n==1?P[d]:0))/23.976),ue=`${V}&t=${se}s`,K=u/23.976,X=`${Math.floor(K/60)}:${("0"+Math.floor(K%60)).slice(-2)}`,E=j(()=>`${It}${n}/${d}/${f}.webp`),L=y(!1),g=y(!1),p=y("連結複製成功"),x=y(!1),_=y(!1),ee=y(!1);async function de(){if(!x.value){x.value=!0,p.value="下載中...",g.value=!0;try{const h=await be(),D=await(await fetch(h)).blob(),T=URL.createObjectURL(D),F=document.createElement("a");F.href=T,F.download=`${t}.png`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(T),p.value="下載完成"}catch(h){ce(h),p.value="下載失敗"}finally{x.value=!1,g.value=!0}}}var B=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);let Q=!1;const te=async h=>{if(Q&&!h){Q=!1;return}if(h&&(Q=!0,B)){p.value="因瀏覽器限制，不支援長按複製連結",g.value=!0;return}if(_.value)return;_.value=!0,g.value=!1;const v=h||l.copyMode;try{v?await he():await Te()}catch(D){if(ce(D),B)p.value="複製失敗，請稍後重試，或切換為複製連結";else try{await he(),p.value="複製圖片失敗，已複製連結"}catch(T){console.error("Error during copy:",T.message),p.value="失敗 請按左下角回報手機型號/瀏覽器",ce(T)}}finally{_.value=!1,g.value=!0}},he=async()=>{await navigator.clipboard.writeText(E.value),p.value="連結複製成功"},Te=async()=>{const h=new ClipboardItem({"image/png":(async()=>{const v=await be();return await(await fetch(v)).blob()})()});await navigator.clipboard.write([h]),p.value="圖片複製成功"},Ue=(()=>{const h=document.createElement("canvas"),v=h.getContext("2d",{alpha:!1,willReadFrequently:!0})??new CanvasRenderingContext2D;return{canvas:h,ctx:v}})();var ae="";async function be(){if(ae)return ae;let h=new Image;h.src=E.value,h.crossOrigin="Anonymous",h.style.display="none",await new Promise(T=>{h.onload=T});const{canvas:v,ctx:D}=Ue;return v.width=h.width,v.height=h.height,D.drawImage(h,0,0),ae=v.toDataURL("image/png"),ae}async function ce(h){const v={content:`Copy failed: ${h.name}

${navigator.userAgent}

${h.message}

${h.stack}`};try{await fetch(`https://discord.com/api/webhooks/${atob(oe.webhook)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})}catch(D){console.error("Failed to send error report to Discord:",D)}}return(h,v)=>{const D=De,T=Me("long-press");return I(),J("div",{style:Pe(m.styles)},[o(z,{class:"card size",color:"surface-variant",rounded:"lg",variant:"tonal",onClick:v[0]||(v[0]=F=>L.value=!0)},{default:r(()=>[b("div",ht,[b("img",{src:E.value,class:"size",alt:w(t)},null,8,bt),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},$(c)+" "+$(X))]),o(pe,{class:"card-text text-center justify-center"},{default:r(()=>[k($(w(t)),1)]),_:1})]),_:1}),o(Z,{modelValue:L.value,"onUpdate:modelValue":v[3]||(v[3]=F=>L.value=F),"max-width":"600px",style:{maxHeight:"90vh"}},{default:r(()=>[o(z,null,{default:r(()=>[b("div",xt,[o(_e,{src:E.value,style:{maxHeight:"70vh",objectFit:"contain"}},null,8,["src"]),b("div",{style:{position:"absolute",top:"0",right:"0",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 5px"}},$(c)+" "+$(X))]),o(H,null,{default:r(()=>[o(q,null,{default:r(()=>[o(pe,{class:"text-center"},{default:r(()=>[k($(w(t)),1)]),_:1})]),_:1})]),_:1}),o(re,null,{default:r(()=>[o(H,null,{default:r(()=>[o(S,null,{default:r(()=>[v[5]||(v[5]=k(" 回報 ")),o(D,{fileName:E.value,text:w(t)},null,8,["fileName","text"])]),_:1}),o(S,{onClick:de,loading:x.value},{default:r(()=>v[6]||(v[6]=[k("下載")])),_:1},8,["loading"]),o(S,{onClick:v[1]||(v[1]=async()=>{if(a.value){ee.value=!0;try{await a.value.CreateGif()}finally{ee.value=!1}}}),loading:ee.value},{default:r(()=>v[7]||(v[7]=[k("GIF")])),_:1},8,["loading"]),Re((I(),O(S,{onClick:v[2]||(v[2]=()=>te(!1)),loading:_.value},{default:r(()=>v[8]||(v[8]=[k("複製")])),_:1},8,["loading"])),[[T,()=>te(!0)]]),o(S,{href:ue,target:"_blank"},{default:r(()=>v[9]||(v[9]=[k(" 從這裡開始看 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(gt,{ref_key:"gifDialogRef",ref:a,text:w(t),season:w(n),episode:w(d),"frame-start":w(u),"frame-end":e.cardData.frameEnd},null,8,["text","season","episode","frame-start","frame-end"]),o(ye,{modelValue:g.value,"onUpdate:modelValue":v[4]||(v[4]=F=>g.value=F),timeout:2e3,class:"text-center",rounded:"pill"},{default:r(()=>[b("div",kt,$(p.value),1)]),_:1},8,["modelValue"])],4)}}}),$e=(m,l)=>{const a=m.__vccOpts||m;for(const[e,t]of l)a[e]=t;return a},St=$e(Vt,[["__scopeId","data-v-54378534"]]),Ot=U({__name:"ResultGrid",setup(m){const l=we(),a=pt();a.fetchData();const{filteredCards:e}=tt(a);let t=y(4);const n=()=>{t.value=(1+Math.floor((window.innerWidth-320)/310))*8},d=j(()=>{typeof window<"u"&&window.scrollTo({top:0,left:0,behavior:"smooth"});const f=e.value;return l.reverse,(s,c)=>{const i=f.slice(s*c,(s+1)*c);return Promise.resolve(i)}}),u=f=>{var s;return(s=f.value)==null?void 0:s.segmentId};return le(()=>{n(),window.addEventListener("resize",n)}),Ee(()=>{window.removeEventListener("resize",n)}),(f,s)=>(I(),O(Le,null,{default:r(()=>[o(w(it),{length:w(e).length?w(e).length:1,pageSize:w(t),pageProvider:d.value,"get-key":u,"page-provider-debounce-time":100,class:"grid ma-5"},{placeholder:r(({index:c,style:i})=>[b("div",{class:"item",style:Pe(i)},$(w(e).length?"還在GO...":""),5)]),default:r(({item:c,style:i,index:V})=>[o(St,{styles:i,cardData:c},null,8,["styles","cardData"])]),_:1},8,["length","pageSize","pageProvider"])]),fallback:r(()=>s[0]||(s[0]=[b("p",null,"Loading...",-1)])),_:1}))}}),Pt=$e(Ot,[["__scopeId","data-v-e1182e96"]]),Oe=U({__name:"MultiSelect",props:je({items:{type:Array,required:!0},label:{type:String,required:!1,default:"Select"}},{modelValue:{type:Array,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const l=m,a=Ge(m,"modelValue"),e=j(()=>a.value.length===l.items.length),t=j(()=>a.value.length>0&&a.value.length<l.items.length),n=()=>{e.value?a.value=[]:a.value=[...l.items]};return W(a,()=>{a.value.sort()}),(d,u)=>(I(),O(Je,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=f=>a.value=f),label:m.label,variant:"outlined",multiple:"",items:m.items,style:{"min-width":"250px"}},{"prepend-item":r(()=>[o(N,{title:"全選",onClick:n},{prepend:r(()=>[o(We,{indeterminate:t.value,"model-value":e.value},null,8,["indeterminate","model-value"])]),_:1}),o(He,{class:"mt-2"})]),selection:r(({item:f,index:s})=>[a.value.length!=m.items.length?(I(),O(ke,{key:0},{default:r(()=>[b("span",null,$(f.value),1)]),_:2},1024)):fe("",!0),s===m.items.length-1?(I(),O(ke,{key:1},{default:r(()=>u[1]||(u[1]=[b("span",null,"全選",-1)])),_:1})):fe("",!0)]),_:1},8,["modelValue","label","items"]))}}),Ct=U({__name:"FilterDialog",setup(m){const l=ge(),a=y(!1),e=y([]),t=y([]),n=y([]),d=()=>{t.value=[],n.value=[],e.value=[]},u=()=>{l.mygoFilter=t.value,l.avemujicaFilter=n.value,l.characterFilter=0,a.value=!1};return le(()=>{const s=new URLSearchParams(window.location.search).get("ep");if(s){for(var c=+s,i=0;c&&i<13;i++){const V=c&1;c=c>>1,V&&t.value.push(i+1)}for(var i=0;c&&i<13;i++){const P=c&1;c=c>>1,P&&n.value.push(i+1)}u()}}),(f,s)=>(I(),O(Z,{modelValue:a.value,"onUpdate:modelValue":s[2]||(s[2]=c=>a.value=c),"max-width":"600px",style:{"min-height":"600px"},transition:"dialog-top-transition"},{activator:r(({props:c})=>[o(ne,Ae(c,{icon:w(Ke)}),null,16,["icon"])]),default:r(()=>[o(z,{class:"d-flex flex-column align-center justify-center font-weight-bold"},{default:r(()=>[s[3]||(s[3]=b("br",null,null,-1)),s[4]||(s[4]=b("br",null,null,-1)),s[5]||(s[5]=b("span",{class:"align-center"},"集數篩選",-1)),o(Oe,{items:Array.from({length:13},(c,i)=>i+1),modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=c=>t.value=c),label:"MyGO",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(Oe,{items:Array.from({length:12},(c,i)=>i+1),modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=c=>n.value=c),label:"Ave Mujica",style:{"min-width":"250px"}},null,8,["items","modelValue"]),o(re,null,{default:r(()=>[o(S,{class:"text-center",text:"清除篩選",onClick:d}),o(S,{class:"text-center",text:"確定",onClick:u})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),_t=U({__name:"AppBarComponent",setup(m){const l=we(),a=ge(),e=y(),t=y(""),n=()=>{clearTimeout(e.value),e.value=setTimeout(d,500)},d=()=>{clearTimeout(e.value),a.query=t.value},u=()=>{t.value="",a.query=""};return le(()=>{const s=new URLSearchParams(window.location.search).get("q");s&&(t.value=s,a.query=s)}),(f,s)=>{const c=Ct;return I(),O(Ze,{density:"prominent"},{default:r(()=>[o(Ce,null,{default:r(()=>[s[2]||(s[2]=b("div",{class:"text-h5 mx-auto font-weight-bold text-center text-truncate"}," MyGO Mujica 截圖搜尋器 ",-1)),o(H,{dense:"",class:"mt-2"},{default:r(()=>[o(q,{class:"text-center"},{default:r(()=>[o(me,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value=i),"single-line":"","hide-details":"",clearable:"",label:"搜尋",variant:"outlined",class:"short-search",onKeyup:Ne(d,["enter"]),"onClick:clear":u,onInput:n,autofocus:""},{append:r(()=>[o(ne,{onClick:s[0]||(s[0]=i=>w(l).reverse=!w(l).reverse),icon:w(l).reverse?w(Xe):w(et)},null,8,["icon"])]),"append-inner":r(()=>[o(c)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),jt=U({__name:"index",setup(m){return(l,a)=>{const e=_t,t=Pt,n=vt;return I(),J(ve,null,[o(e),o(t),o(n,{style:{width:"100%"}})],64)}}});export{jt as default};
