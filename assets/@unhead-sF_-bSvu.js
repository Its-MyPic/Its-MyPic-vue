import{c as j}from"./unhead-ZucKmTwK.js";import{n as I,v as R,u as O}from"./@vue-CwslLISx.js";const U=new Set(["title","titleTemplate","script","style","noscript"]),A=new Set(["base","meta","link","style","script","noscript"]),W=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),K=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),E=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]),oe=typeof window<"u";function ie(e){return e}function _(e){let t=9;for(let n=0;n<e.length;)t=Math.imul(t^e.charCodeAt(n++),9**9);return((t^t>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function v(e){if(e._h)return e._h;if(e._d)return _(e._d);let t=`${e.tag}:${e.textContent||e.innerHTML||""}:`;for(const n in e.props)t+=`${n}:${String(e.props[n])},`;return _(t)}function q(e,t){return e instanceof Promise?e.then(t):t(e)}function H(e,t,n,o){const i=o||$(typeof t=="object"&&typeof t!="function"&&!(t instanceof Promise)?{...t}:{[e==="script"||e==="noscript"||e==="style"?"innerHTML":"textContent"]:t},e==="templateParams"||e==="titleTemplate");if(i instanceof Promise)return i.then(s=>H(e,t,n,s));const r={tag:e,props:i};for(const s of E){const d=r.props[s]!==void 0?r.props[s]:n[s];d!==void 0&&((!(s==="innerHTML"||s==="textContent"||s==="children")||U.has(r.tag))&&(r[s==="children"?"innerHTML":s]=d),delete r.props[s])}return r.props.body&&(r.tagPosition="bodyClose",delete r.props.body),r.tag==="script"&&typeof r.innerHTML=="object"&&(r.innerHTML=JSON.stringify(r.innerHTML),r.props.type=r.props.type||"application/json"),Array.isArray(r.props.content)?r.props.content.map(s=>({...r,props:{...r.props,content:s}})):r}function B(e,t){var o;const n=e==="class"?" ":";";return t&&typeof t=="object"&&!Array.isArray(t)&&(t=Object.entries(t).filter(([,i])=>i).map(([i,r])=>e==="style"?`${i}:${r}`:i)),(o=String(Array.isArray(t)?t.join(n):t))==null?void 0:o.split(n).filter(i=>!!i.trim()).join(n)}function k(e,t,n,o){for(let i=o;i<n.length;i+=1){const r=n[i];if(r==="class"||r==="style"){e[r]=B(r,e[r]);continue}if(e[r]instanceof Promise)return e[r].then(s=>(e[r]=s,k(e,t,n,i)));if(!t&&!E.has(r)){const s=String(e[r]),d=r.startsWith("data-");s==="true"||s===""?e[r]=d?"true":!0:e[r]||(d&&s==="false"?e[r]="false":delete e[r])}}}function $(e,t=!1){const n=k(e,t,Object.keys(e),0);return n instanceof Promise?n.then(()=>e):e}const V=10;function D(e,t,n){for(let o=n;o<t.length;o+=1){const i=t[o];if(i instanceof Promise)return i.then(r=>(t[o]=r,D(e,t,o)));Array.isArray(i)?e.push(...i):e.push(i)}}function se(e){const t=[],n=e.resolvedInput;for(const i in n){if(!Object.prototype.hasOwnProperty.call(n,i))continue;const r=n[i];if(!(r===void 0||!W.has(i))){if(Array.isArray(r)){for(const s of r)t.push(H(i,s,e));continue}t.push(H(i,r,e))}}if(t.length===0)return[];const o=[];return q(D(o,t,0),()=>o.map((i,r)=>(i._e=e._i,e.mode&&(i._m=e.mode),i._p=(e._i<<V)+r,i)))}const ce=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),x={base:-10,title:10},L={critical:-80,high:-10,low:20};function ae(e){const t=e.tagPriority;if(typeof t=="number")return t;let n=100;return e.tag==="meta"?e.props["http-equiv"]==="content-security-policy"?n=-30:e.props.charset?n=-20:e.props.name==="viewport"&&(n=-15):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in x&&(n=x[e.tag]),t&&t in L?n+L[t]:n}const fe=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],F=["name","property","http-equiv"];function G(e){const{props:t,tag:n}=e;if(K.has(n))return n;if(n==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";if(t.id)return`${n}:id:${t.id}`;for(const o of F)if(t[o]!==void 0)return`${n}:${o}:${t[o]}`;return!1}const h="%separator";function N(e,t,n=!1){var i;let o;if(t==="s"||t==="pageTitle")o=e.pageTitle;else if(t.includes(".")){const r=t.indexOf(".");o=(i=e[t.substring(0,r)])==null?void 0:i[t.substring(r+1)]}else o=e[t];if(o!==void 0)return n?(o||"").replace(/"/g,'\\"'):o||""}const J=new RegExp(`${h}(?:\\s*${h})*`,"g");function le(e,t,n,o=!1){if(typeof e!="string"||!e.includes("%"))return e;let i=e;try{i=decodeURI(e)}catch{}const r=i.match(/%\w+(?:\.\w+)?/g);if(!r)return e;const s=e.includes(h);return e=e.replace(/%\w+(?:\.\w+)?/g,d=>{if(d===h||!r.includes(d))return d;const g=N(t,d.slice(1),o);return g!==void 0?g:d}).trim(),s&&(e.endsWith(h)&&(e=e.slice(0,-h.length)),e.startsWith(h)&&(e=e.slice(h.length)),e=e.replace(J,n).trim()),e}function de(e,t){return e==null?t||null:typeof e=="function"?e(t):e}async function z(e,t={}){const n=t.document||e.resolvedOptions.document;if(!n||!e.dirty)return;const o={shouldRender:!0,tags:[]};if(await e.hooks.callHook("dom:beforeRender",o),!!o.shouldRender)return e._domUpdatePromise||(e._domUpdatePromise=new Promise(async i=>{var M;const r=(await e.resolveTags()).map(c=>({tag:c,id:A.has(c.tag)?v(c):c.tag,shouldRender:!0}));let s=e._dom;if(!s){s={elMap:{htmlAttrs:n.documentElement,bodyAttrs:n.body}};const c=new Set;for(const a of["body","head"]){const f=(M=n[a])==null?void 0:M.children;for(const u of f){const l=u.tagName.toLowerCase();if(!A.has(l))continue;const y={tag:l,props:await $(u.getAttributeNames().reduce((T,w)=>({...T,[w]:u.getAttribute(w)}),{})),innerHTML:u.innerHTML},b=G(y);let p=b,P=1;for(;p&&c.has(p);)p=`${b}:${P++}`;p&&(y._d=p,c.add(p)),s.elMap[u.getAttribute("data-hid")||v(y)]=u}}}s.pendingSideEffects={...s.sideEffects},s.sideEffects={};function d(c,a,f){const u=`${c}:${a}`;s.sideEffects[u]=f,delete s.pendingSideEffects[u]}function g({id:c,$el:a,tag:f}){const u=f.tag.endsWith("Attrs");if(s.elMap[c]=a,u||(f.textContent&&f.textContent!==a.textContent&&(a.textContent=f.textContent),f.innerHTML&&f.innerHTML!==a.innerHTML&&(a.innerHTML=f.innerHTML),d(c,"el",()=>{var l;(l=s.elMap[c])==null||l.remove(),delete s.elMap[c]})),f._eventHandlers)for(const l in f._eventHandlers)Object.prototype.hasOwnProperty.call(f._eventHandlers,l)&&a.getAttribute(`data-${l}`)!==""&&((f.tag==="bodyAttrs"?n.defaultView:a).addEventListener(l.substring(2),f._eventHandlers[l].bind(a)),a.setAttribute(`data-${l}`,""));for(const l in f.props){if(!Object.prototype.hasOwnProperty.call(f.props,l))continue;const y=f.props[l],b=`attr:${l}`;if(l==="class"){if(!y)continue;for(const p of y.split(" "))u&&d(c,`${b}:${p}`,()=>a.classList.remove(p)),!a.classList.contains(p)&&a.classList.add(p)}else if(l==="style"){if(!y)continue;for(const p of y.split(";")){const P=p.indexOf(":"),T=p.substring(0,P).trim(),w=p.substring(P+1).trim();d(c,`${b}:${T}`,()=>{a.style.removeProperty(T)}),a.style.setProperty(T,w)}}else a.getAttribute(l)!==y&&a.setAttribute(l,y===!0?"":String(y)),u&&d(c,b,()=>a.removeAttribute(l))}}const C=[],m={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const c of r){const{tag:a,shouldRender:f,id:u}=c;if(f){if(a.tag==="title"){n.title=a.textContent;continue}c.$el=c.$el||s.elMap[u],c.$el?g(c):A.has(a.tag)&&C.push(c)}}for(const c of C){const a=c.tag.tagPosition||"head";c.$el=n.createElement(c.tag.tag),g(c),m[a]=m[a]||n.createDocumentFragment(),m[a].appendChild(c.$el)}for(const c of r)await e.hooks.callHook("dom:renderTag",c,n,d);m.head&&n.head.appendChild(m.head),m.bodyOpen&&n.body.insertBefore(m.bodyOpen,n.body.firstChild),m.bodyClose&&n.body.appendChild(m.bodyClose);for(const c in s.pendingSideEffects)s.pendingSideEffects[c]();e._dom=s,await e.hooks.callHook("dom:rendered",{renders:r}),i()}).finally(()=>{e._domUpdatePromise=void 0,e.dirty=!1})),e._domUpdatePromise}function Q(e,t={}){const n=t.delayFn||(o=>setTimeout(o,10));return e._domDebouncedUpdatePromise=e._domDebouncedUpdatePromise||new Promise(o=>n(()=>z(e,t).then(()=>{delete e._domDebouncedUpdatePromise,o()})))}function ue(e){return t=>{var o,i;const n=((i=(o=t.resolvedOptions.document)==null?void 0:o.head.querySelector('script[id="unhead:payload"]'))==null?void 0:i.innerHTML)||!1;return n&&t.push(JSON.parse(n)),{mode:"client",hooks:{"entries:updated":r=>{Q(r,e)}}}}}const X=R[0]==="3";function Y(e){return typeof e=="function"?e():O(e)}function S(e){if(e instanceof Promise||e instanceof Date||e instanceof RegExp)return e;const t=Y(e);if(!e||!t)return t;if(Array.isArray(t))return t.map(n=>S(n));if(typeof t=="object"){const n={};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(o==="titleTemplate"||o[0]==="o"&&o[1]==="n"){n[o]=O(t[o]);continue}n[o]=S(t[o])}return n}return t}const Z={hooks:{"entries:resolve":e=>{for(const t of e.entries)t.resolvedInput=S(t.input)}}},ee="usehead";function te(e){return{install(n){X&&(n.config.globalProperties.$unhead=e,n.config.globalProperties.$head=e,n.provide(ee,e))}}.install}function pe(e={}){e.domDelayFn=e.domDelayFn||(n=>I(()=>setTimeout(()=>n(),0)));const t=j(e);return t.use(Z),t.install=te(t),t}export{ue as D,A as H,oe as I,ce as N,fe as S,ae as a,_ as b,pe as c,ie as d,v as h,se as n,le as p,de as r,G as t};
