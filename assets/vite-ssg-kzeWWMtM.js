import{c as _}from"./@unhead-1F6_GQsg.js";import{k as C,r as h,l as I,p as g}from"./@vue-B5CsDmzc.js";import{c as O,a as T}from"./vue-router-BuURmejg.js";function b(t){return document.readyState==="loading"?new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e(t))}):Promise.resolve(t)}const v=C({setup(t,{slots:e}){const r=h(!1);return I(()=>r.value=!0),()=>r.value?e.default&&e.default({}):e.placeholder&&e.placeholder({})}});function E(t){try{return JSON.parse(t||"{}")}catch(e){return console.error("[SSG] On state deserialization -",e,t),{}}}function G(t,e,r,L){const{transformState:i,registerComponents:S=!0,useHead:m=!0,rootContainer:f="#app"}={};async function p(s){const n=g(t);let d;m&&n.use(d=_());const c=O({history:T(e.base),...e}),{routes:R}=e;S&&n.component("ClientOnly",v);const y=[],a={app:n,head:d,isClient:!0,router:c,routes:R,onSSRAppRendered:()=>{},triggerOnSSRAppRendered:()=>Promise.all(y.map(o=>o())),initialState:{},transformState:i,routePath:s};await b(),a.initialState=(i==null?void 0:i(window.__INITIAL_STATE__||{}))||E(window.__INITIAL_STATE__),await(r==null?void 0:r(a)),n.use(c);let u,l=!0;c.beforeEach((o,N,w)=>{(l||u&&u===o.path)&&(l=!1,u=o.path,o.meta.state=a.initialState),w()});const A=a.initialState;return{...a,initialState:A}}return(async()=>{const{app:s,router:n}=await p();await n.isReady(),s.mount(f,!0)})(),p}export{G as V};
